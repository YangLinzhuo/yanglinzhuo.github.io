{
    "version": "https://jsonfeed.org/version/1",
    "title": "林•初夏 • All posts by \"hexo\" tag",
    "description": "Linn's Personal Blog Site",
    "home_page_url": "https://linn-ylz.com",
    "items": [
        {
            "id": "https://linn-ylz.com/Hexo/transfer-waline-2/",
            "url": "https://linn-ylz.com/Hexo/transfer-waline-2/",
            "title": "ShokaX 主题迁移",
            "date_published": "2024-11-09T10:09:10.000Z",
            "content_html": "<h1 id=\"前言\"><a class=\"markdownIt-Anchor\" href=\"#前言\">#</a> 前言</h1>\n<p>近日尝试在新电脑上配置博客环境，发现原来的  <code>Shoka</code>  主题已经过于陈旧了，环境搭建非常困难，依赖的软件包版本老旧，并且原作者没有时间在进行维护和开发，已经到了需要动手解决以下的时候了。在之前的文章<a href=\"/Computer-Science/Algorithm/about-binary-search/\" title=\"二分搜索探究\">《从 Valine 迁移到 Waline》</a>中，介绍了从  <code>Valine</code>  迁移到  <code>Waline</code>  的方法。因为  <code>Shoka</code>  主题的原因，在迁移过程中遇到了很多问题，只能通过一些临时的方法来解决，造成了维护上的困难。这也最终让我下定决心更换到新的  <code>ShokaX</code>  主题。</p>\n<p>一段时间前曾经尝试过切换到  <code>ShokaX</code>  主题，但是当时这个新主题也还未稳定，存在一些问题，加之工作太忙，没时间抽空完成迁移。最近  <code>ShokaX</code>  主题也算稳定了下来，于是趁着在新电脑上搭建环境的机会，正好一并迁移过来。</p>\n<p>按照  <code>ShokaX</code>  自己的说法，它是 “ <code>Shoka</code>  的一个二次开发版（算精神续作），致力于提高性能和优化魔改体验，诞生原因是目前  <code>Shoka</code>  已经三年没有更新了，积压了大量 BUG 和功能请求。”</p>\n<p>本篇文章就是对迁移过程中问题的一个记录，便于之后复现博客环境。</p>\n<h1 id=\"第三方工具\"><a class=\"markdownIt-Anchor\" href=\"#第三方工具\">#</a> 第三方工具</h1>\n<h2 id=\"git\"><a class=\"markdownIt-Anchor\" href=\"#git\">#</a> Git</h2>\n<p>这次新环境的网络遇到些问题， <code>Git</code>  仓库总是无法拉取。</p>\n<p>首先是报错  <code>port 22 connection refused</code> ，这个参考外网的一个办法<sup class=\"footnote-ref\"><a href=\"#fn1\" id=\"fnref1\">[1]</a></sup>解决了。其做法是在  <code>~/.ssh/config</code>  中添加如下配置，让  <code>Git</code>  连接走 443 端口：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># GitHub config</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Host github.com</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    Hostname ssh.github.com</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    Port 443</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    User git</pre></td></tr></table></figure><p>上述问题解决后，一段时间能够正常工作，后来又遇到问题，这次换 443 端口也拒绝连接请求了…。最后配置了  <code>WSL</code>  环境的代理之后才总算是告一段落。</p>\n<p>具体而言是添加如下环境变量：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">hostip</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">ip</span> route show <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-i</span> default <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> <span class=\"token string\">'&#123; print $3&#125;'</span><span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">https_proxy</span><span class=\"token operator\">=</span><span class=\"token string\">\"http://<span class=\"token variable\">$&#123;hostip&#125;</span>:7890\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">http_proxy</span><span class=\"token operator\">=</span><span class=\"token string\">\"http://<span class=\"token variable\">$&#123;hostip&#125;</span>:7890\"</span></pre></td></tr></table></figure><p>也可以在  <code>.bashrc</code>  或者  <code>.zshrc</code>  等环境配置文件中添加，这样每次启动之后就会自动设置代理。这里的端口注意修改为自己代理软件对应的端口。这里主要参考了一篇 WSL2 环境使用 Clash 代理的记录<sup class=\"footnote-ref\"><a href=\"#fn2\" id=\"fnref2\">[2]</a></sup>以及微软官方 WSL 使用命令说明<sup class=\"footnote-ref\"><a href=\"#fn3\" id=\"fnref3\">[3]</a></sup>。</p>\n<h2 id=\"nodejs\"><a class=\"markdownIt-Anchor\" href=\"#nodejs\">#</a> Node.js</h2>\n<p>然后是  <code>Node.js</code>  安装。这里推荐使用  <code>nvm</code> <sup class=\"footnote-ref\"><a href=\"#fn4\" id=\"fnref4\">[4]</a></sup> 这个软件包来管理  <code>Node.js</code>  的环境。</p>\n<p>如果想使用其他方法安装，可以参考相关博客<sup class=\"footnote-ref\"><a href=\"#fn5\" id=\"fnref5\">[5]</a></sup>。</p>\n<p>首先执行以下命令安装  <code>nvm</code> ：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">curl</span> -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.1/install.sh <span class=\"token operator\">|</span> <span class=\"token function\">bash</span></pre></td></tr></table></figure><p>注意版本号可能会有差别。</p>\n<p>然后初始化环境：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">source</span> ~/.zshrc</pre></td></tr></table></figure><p>使用  <code>bash</code>  的话就是  <code>source ~/.bashrc</code> 。</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>nvm list-remote  <span class=\"token comment\"># 查看 NVM 哪些版本的 Node 可用</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>nvm <span class=\"token function\">install</span> <span class=\"token parameter variable\">--lts</span>  <span class=\"token comment\"># 下载 lts 最新版</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 验证版本</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">node</span> <span class=\"token parameter variable\">-v</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">npm</span> <span class=\"token parameter variable\">-v</span></pre></td></tr></table></figure><h1 id=\"shokax-主题安装\"><a class=\"markdownIt-Anchor\" href=\"#shokax-主题安装\">#</a> ShokaX 主题安装</h1>\n<p><code>ShokaX</code>  官方推荐使用  <code>pnpm</code>  管理包，因此需要先安装：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">-g</span> <span class=\"token function\">pnpm</span></pre></td></tr></table></figure><p><code>ShokaX</code>  的官方文档<sup class=\"footnote-ref\"><a href=\"#fn6\" id=\"fnref6\">[6]</a></sup>中有详细的安装说明。如果不想折腾，那么可以选择其中的第一种方式，所谓 “ShokaX 即食罐头”：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">git</span> clone https://github.com/theme-shoka-x/shokax-can <span class=\"token parameter variable\">--depth</span><span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">cd</span> shokax-can</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">pnpm</span> <span class=\"token function\">install</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>hexo s <span class=\"token comment\"># 如果报错更换为 pnpm dlx hexo s</span></pre></td></tr></table></figure><p>我因为有之前写的文档，所以采用  <code>Git</code>  安装的方式，将  <code>ShokaX</code>  主题安装到  <code>themes</code>  文件夹下：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> themes</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">git</span> clone https://github.com/theme-shoka-x/hexo-theme-shokaX.git <span class=\"token comment\"># 可替换为你自己的项目</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">cd</span> shokax</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">node</span> ./toolbox/compiler.mjs</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">cd</span> <span class=\"token punctuation\">..</span>/<span class=\"token punctuation\">..</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>hexo s <span class=\"token comment\"># 或 pnpm dlx hexo s</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">node</span> ./themes/shokax/toolbox/hoistdep.mjs</pre></td></tr></table></figure><p>上述  <code>node</code>  命令执行中可能会缺少一些依赖，直接安装即可：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 安装 node 执行命令依赖</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">pnpm</span> <span class=\"token function\">install</span> esbuild</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">pnpm</span> <span class=\"token function\">install</span> glob</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 安装主题依赖</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">pnpm</span> <span class=\"token function\">install</span></pre></td></tr></table></figure><h1 id=\"shokax-主题配置\"><a class=\"markdownIt-Anchor\" href=\"#shokax-主题配置\">#</a> ShokaX 主题配置</h1>\n<p>主题配置主要参考  <code>ShokaX</code>  的官方文档<sup class=\"footnote-ref\"><a href=\"#fn6\" id=\"fnref6:1\">[6:1]</a></sup>中的配置相关部分，其中注意以下配置：</p>\n<figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">syntax_highlighter</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span></pre></td></tr></table></figure><p>在  <code>hexo</code>  大于等于  <code>7.0.0-rc1</code>  的时候需要按照上面的方式设置，否则可能代码块渲染不对。</p>\n<p>此外， <code>ShokaX</code>  中的某些图片资源存放在了  <code>assets</code>  文件夹而非原来的  <code>images</code>  文件夹，如果有图片链接出现了问题，可以  <code>F12</code>  浏览器工具查看图片是否路径正确。</p>\n<p>其他的配置基本上是从原来的  <code>Shoka</code>  配置中复制而来。</p>\n<h1 id=\"重新部署-vercel\"><a class=\"markdownIt-Anchor\" href=\"#重新部署-vercel\">#</a> 重新部署 Vercel</h1>\n<p>在本地部署之后，发现评论系统的无法访问到后端的地址。经过排查发现是 Vercel 部署的评论后端和当前主题使用的  <code>waline</code>  版本不匹配导致的。新版的  <code>waline</code>  在请求链接中会添加  <code>/api</code>  的部分，而原来的版本中则没有，因此访问会产生 404。解决方法即用新版本  <code>waline</code>  重新部署。具体部署步骤可以查看之前的文章<a href=\"/Computer-Science/Algorithm/about-binary-search/\" title=\"二分搜索探究\">《从 Valine 迁移到 Waline》</a>。</p>\n<p>记得复制环境变量以及添加域名。</p>\n<h1 id=\"一键部署\"><a class=\"markdownIt-Anchor\" href=\"#一键部署\">#</a> 一键部署</h1>\n<p>一键部署需要安装  <code>hexo</code>  的工具：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">pnpm</span> <span class=\"token function\">install</span> hexo-deployer-git</pre></td></tr></table></figure><p>并在配置文件中配置部署的仓库信息：</p>\n<figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">deploy</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> git</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token key atrule\">repo</span><span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span>//github.com/YangLinzhuo/yanglinzhuo.github.io</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token key atrule\">branch</span><span class=\"token punctuation\">:</span> master</pre></td></tr></table></figure><p>搭建完成并部署到  <code>GitHubPages</code>  之后发现网页白屏，排查发现是生成的  <code>index.html</code>  文件为空<sup class=\"footnote-ref\"><a href=\"#fn7\" id=\"fnref7\">[7]</a></sup>。重新生成部署后解决。</p>\n<h1 id=\"修改主题\"><a class=\"markdownIt-Anchor\" href=\"#修改主题\">#</a> 修改主题</h1>\n<p>排查中顺便修改了一下主题内容  <code>themes/shokax/layout/_partials/post/footer.pug</code> ：</p>\n<figure class=\"highlight pug\"><figcaption data-lang=\"pug\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\">div<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">class</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"meta\"</span></span><span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token flow-control\"><span class=\"token branch keyword\">if</span> <span class=\"token function\">date</span><span class=\"token punctuation\">(</span>post<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token function\">date</span><span class=\"token punctuation\">(</span>post<span class=\"token punctuation\">.</span>updated<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token function\">time</span><span class=\"token punctuation\">(</span>post<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token function\">time</span><span class=\"token punctuation\">(</span>post<span class=\"token punctuation\">.</span>updated<span class=\"token punctuation\">)</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token tag\">span<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">class</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"item\"</span></span><span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token tag\">span<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">class</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"icon\"</span></span><span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                <span class=\"token tag\">i<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">class</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"ic i-calendar-check\"</span></span><span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token tag\">span<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">class</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"text\"</span></span><span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                <span class=\"token punctuation\">!=</span><span class=\"token code\"> <span class=\"token function\">__</span><span class=\"token punctuation\">(</span><span class=\"token string\">'post.edited'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">__</span><span class=\"token punctuation\">(</span><span class=\"token string\">'symbol.space'</span><span class=\"token punctuation\">)</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token tag\">time<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">title</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token function\">__</span><span class=\"token punctuation\">(</span><span class=\"token string\">'post.modified'</span></span><span class=\"token punctuation\">)</span></span></span> <span class=\"token plain-text\">+ __('symbol.colon') + full_date(post.updated) itemprop=\"dateModified\" datetime=moment(post.updated).format())</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token punctuation\">!=</span><span class=\"token code\"> <span class=\"token function\">date</span><span class=\"token punctuation\">(</span>post<span class=\"token punctuation\">.</span>updated<span class=\"token punctuation\">)</span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token flow-control\"><span class=\"token branch keyword\">if</span> theme<span class=\"token punctuation\">.</span>twikoo<span class=\"token punctuation\">.</span>enable <span class=\"token operator\">||</span> theme<span class=\"token punctuation\">.</span>waline<span class=\"token punctuation\">.</span>pageview</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token tag\">span<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">class</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"item\"</span></span><span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token tag\">span<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">class</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"icon\"</span></span><span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                <span class=\"token tag\">i<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">class</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"ic i-eye\"</span></span><span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token tag\">span<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">class</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"text\"</span></span><span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                <span class=\"token punctuation\">!=</span><span class=\"token code\"><span class=\"token function\">__</span><span class=\"token punctuation\">(</span><span class=\"token string\">'footer.total_views'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">__</span><span class=\"token punctuation\">(</span><span class=\"token string\">'symbol.colon'</span><span class=\"token punctuation\">)</span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token punctuation\">-</span><span class=\"token code\"> <span class=\"token keyword\">var</span> prefixedPath <span class=\"token operator\">=</span> post<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">startsWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> post<span class=\"token punctuation\">.</span>path <span class=\"token operator\">:</span> <span class=\"token string\">'/'</span> <span class=\"token operator\">+</span> post<span class=\"token punctuation\">.</span>path</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token tag\">span<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">id</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"twikoo_visitors\"</span> <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"waline-pageview-count\"</span> data<span class=\"token operator\">-</span>path<span class=\"token operator\">=</span>prefixedPath</span><span class=\"token punctuation\">)</span></span></span> <span class=\"token plain-text\">正在加载...</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">!=</span><span class=\"token code\"> <span class=\"token function\">shokax_inject</span><span class=\"token punctuation\">(</span><span class=\"token string\">'postMeta'</span><span class=\"token punctuation\">)</span></span></pre></td></tr></table></figure><hr class=\"footnotes-sep\">\n<section class=\"footnotes\">\n<ol class=\"footnotes-list\">\n<li id=\"fn1\" class=\"footnote-item\"><p><a href=\"https://backendtea.com/post/ssh-could-not-connect/\">How to fix “connect to host github.com port 22: Operation timed out” | BackEndTea</a> <a href=\"#fnref1\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn2\" class=\"footnote-item\"><p><a href=\"https://gist.github.com/libChan/3a804a46b532cc326a2ee55b27e8ac19?permalink_comment_id=4841732\">WSL2 使用 clash for windows 代理</a> <a href=\"#fnref2\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn3\" class=\"footnote-item\"><p><a href=\"https://learn.microsoft.com/zh-cn/windows/wsl/networking#identify-ip-address\">使用 WSL 访问网络应用程序 | Microsoft Learn</a> <a href=\"#fnref3\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn4\" class=\"footnote-item\"><p><a href=\"https://github.com/nvm-sh/nvm\">nvm-sh/nvm: Node Version Manager - POSIX-compliant bash script to manage multiple active node.js versions</a> <a href=\"#fnref4\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn5\" class=\"footnote-item\"><p><a href=\"https://www.cnblogs.com/echohye/p/18271522\">Ubuntu 22.04 安装 NodeJS - 槑孒 - 博客园</a> <a href=\"#fnref5\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn6\" class=\"footnote-item\"><p><a href=\"https://docs-hexo.shokax.top/getting-started/\">安装 ShokaX | ShokaX Docs</a> <a href=\"#fnref6\" class=\"footnote-backref\">↩︎</a> <a href=\"#fnref6:1\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn7\" class=\"footnote-item\"><p><a href=\"https://blog.csdn.net/weixin_45178128/article/details/121230175\">Hexo+github 搭博客，搭完后访问发现白屏了，什么也没有。_hexo 部署后网站空白 - CSDN 博客</a> <a href=\"#fnref7\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n</ol>\n</section>\n",
            "tags": [
                "Hexo",
                "Valine",
                "Waline"
            ]
        },
        {
            "id": "https://linn-ylz.com/TiddlyWiki/tilddlywiki-intro/",
            "url": "https://linn-ylz.com/TiddlyWiki/tilddlywiki-intro/",
            "title": "TiddlyWiki 介绍",
            "date_published": "2022-07-28T16:26:29.000Z",
            "content_html": "<h1 id=\"简介\"><a class=\"markdownIt-Anchor\" href=\"#简介\">#</a> 简介</h1>\n<p><code>TiddlyWiki</code>  是一款受欢迎的个人  <code>Wiki</code>  制作交互式工具。 <code>TiddlyWiki</code>  通过最小的有意义的语义块 —— <code>tiddlers</code> （条目）来构建自己的知识库。通过标题唯一标记  <code>tiddlers</code> ，以便可以使用链接、标签、列表和宏进行结构化。条目（ <code>Tiddlers</code> ）使用维基文本（ <code>WikiText</code> ）符号，能够简明扼要地表示了各种文本格式和超文本功能。具体可以参考<a href=\"https://tiddlywiki.com/\">官方网站</a>。</p>\n<p>虽然  <code>TiddlyWiki</code>  本身是个非常有用的工具，可配置程度很高，但是上手难度也较大。这里比较推荐使用  <code>TiddlyWiki xp</code>  上手，可以戳此<a href=\"https://keatonlao.github.io/tiddlywiki-xp/\">链接</a>。 <code>TiddlyWiki xp</code>  本身配置了较多有用的插件，省却了自己动手配置的麻烦。同时，该  <code>Wiki</code>  中包含了丰富的教程，可以不断阅读深入了解该工具的使用方法。</p>\n<h1 id=\"安装与启动\"><a class=\"markdownIt-Anchor\" href=\"#安装与启动\">#</a> 安装与启动</h1>\n<p>安装  <code>TiddlyWiki</code>  有多种方法。可以选择单一的  <code>html</code>  文件进行编辑，但是这样当以后内容过多时，文件体积便会较大，打开编辑时也会有不便。因此我选择了使用  <code>Node.js</code>  进行安装。因为安装过  <code>Hexo</code> ，所以  <code>Node.js</code>  的相关配置已经做好，只需要通过以下命令直接安装即可：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">-g</span> tiddlywiki</pre></td></tr></table></figure><p>输入  <code>tiddlywiki --version</code>  能够看到版本号则说明成功安装。</p>\n<p>之后下载  <code>TiddlyWiki xp</code>  的压缩包并解压，然后  <code>cd</code>  到该文件夹下，其中应当包含  <code>xp</code>  和  <code>MyPluginStore</code>  两个文件夹。</p>\n<p>通过  <code>tiddlywiki xp --server</code>  可以启动服务，在浏览器中输入  <code>localhost:8080</code>  即可访问网页。不过，现在看到的网页还并不完全，网页显示的内容也仅占据左边的部分，右边产生了许多的空白。这是因为  <code>TiddlyWiki xp</code>  配置了许多插件，输入  <code>tiddlywiki xp --server</code>  命令后，不出意外应该会看到许多插件无法加载的警告。</p>\n<p>在这里，我们需要把存放了插件的文件夹  <code>MyPluginStore</code>  添加到环境变量中。之后，上述报错应当消除，网页也能够正常显示了。</p>\n<h1 id=\"和博客进行搭配\"><a class=\"markdownIt-Anchor\" href=\"#和博客进行搭配\">#</a> 和博客进行搭配</h1>\n<p>通过以上步骤我们能够成功启动  <code>TiddlyWiki</code>  的服务并进行编辑，但是还无法和我们的博客进行结合。当我们将需要的内容编辑完毕之后，需要使用以下指令进行构建：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>tiddlywiki xp <span class=\"token parameter variable\">--build</span> index</pre></td></tr></table></figure><p>该指令会在  <code>xp/output/</code>  文件夹之下产生一个  <code>index.html</code>  文件，将该网页文件放在博客构建完成的文件夹下即可在博客中进行访问。我个人在博客的  <code>source</code>  文件夹下创建了  <code>wiki</code>  文件夹，在其中添加了  <code>index.md</code>  文件以生成  <code>index.html</code>  文件，并在首页侧栏添加了对应的图标和入口。在博客构建完成之后，使用  <code>tiddlywiki</code>  指令生成的  <code>index.html</code>  替换即可。</p>\n<p>通过以上方式即可在博客中添加  <code>Wiki</code>  的入口。</p>\n",
            "tags": [
                "Hexo",
                "TiddlyWiki"
            ]
        },
        {
            "id": "https://linn-ylz.com/Hexo/transfer-waline/",
            "url": "https://linn-ylz.com/Hexo/transfer-waline/",
            "title": "从 Valine 迁移到 Waline",
            "date_published": "2022-07-24T07:09:21.000Z",
            "content_html": "<div class=\"note info\">\n<p>2022-12-02 更新<br>\n根据评论区小伙伴 @<a href=\"https://maredevi.fun/\">MareDevi</a> 的介绍，成功解决了文章浏览量显示的问题，撒花！🌸</p>\n</div>\n<div class=\"note warning\">\n<p><s>想来想去，很多问题还是没有解决，主要还是  <code>Waline</code>  与博客主题不完全兼容，加上自己对前端也不是很了解，最后还是改了回去。真是太折腾了。流石程序员。</s></p>\n</div>\n<h1 id=\"前言\"><a class=\"markdownIt-Anchor\" href=\"#前言\">#</a> 前言</h1>\n<p>由于  <code>Valine</code>  评论系统的通知问题以及其他原因，考虑更换  <code>Waline</code>  作为新的评论系统，但是原来的  <code>Shoka</code>  主题使用的是作者修改后的  <code>MiniValine</code>  系统，在修改上碰到了很大的麻烦，<s>最后只能忍痛割爱更换了现在的  <code>butterfly</code>  主题。这次更换也是对博客进行了一个大刀阔斧的修改，但是也摆脱了  <code>Valine</code>  系统这个累赘。原来经常有评论无法及时提醒，而我自己有时候又不会经常上网站查看，因此有的消息过了很久才能发现。最后还是下定决心进行迁移。</s></p>\n<p>经过查找，发现了一个小姐姐提供的修改方法<sup class=\"footnote-ref\"><a href=\"#fn1\" id=\"fnref1\">[1]</a></sup>，在  <code>Shoka</code>  中能够引入  <code>Waline</code>  。最后还是保留了  <code>Shoka</code>  主题，然后将评论系统换成了  <code>Waline</code>  的系统，虽然还有一些兼容性上的问题，但总归还算保住了现在这个好看的主题。有些小问题折腾了几天也没能完全解决，姑且就到此为止吧。关于遇到的问题，在文章最后一小节有补充。</p>\n<h1 id=\"域名注册\"><a class=\"markdownIt-Anchor\" href=\"#域名注册\">#</a> 域名注册</h1>\n<p>这次顺便更换了一个自己的域名。经过一番搜索后选择了 <a href=\"https://www.dynadot.com/\">Dynadot</a> 域名商，域名就是现在的  <code>linn-ylz.com</code> 。依照教程<sup class=\"footnote-ref\"><a href=\"#fn2\" id=\"fnref2\">[2]</a></sup>购买域名，全部完成之后，使用  <code>Cloudflare</code>  的  <code>DNS</code>  服务，参考另一个教程<sup class=\"footnote-ref\"><a href=\"#fn3\" id=\"fnref3\">[3]</a></sup>。</p>\n<p>以上的步骤按照教程基本能够比较轻松地完成，不多赘述。</p>\n<h2 id=\"自定义域名\"><a class=\"markdownIt-Anchor\" href=\"#自定义域名\">#</a> 自定义域名</h2>\n<p>在  <code>Vercel</code>  中设置自定义域名需要和  <code>Cloudflare</code>  的配置相匹配，具体可以参考这篇<a href=\"https://tangly1024.com/article/vercel-domain\">教程</a>。需要注意，在  <code>Cloudflare</code>  中，需要将  <code>SSL/TLS</code>  的加密模式设置为完全（Full），否则可能会遇到 “重定向过多” 的错误而无法访问。</p>\n<h1 id=\"更换-waline\"><a class=\"markdownIt-Anchor\" href=\"#更换-waline\">#</a> 更换 Waline</h1>\n<p>按照  <code>Waline</code>  的<a href=\"https://waline.js.org/guide/get-started.html\">教程</a>进行配置。</p>\n<h2 id=\"leancloud-设置\"><a class=\"markdownIt-Anchor\" href=\"#leancloud-设置\">#</a> LeanCloud 设置</h2>\n<p>因为之前已经注册配置过  <code>LeanCloud</code>  了，所以这里不再赘述。可以参考之前的文章<a href=\"/Hexo/blog-comment-push/\" title=\"Shoka 评论推送功能实现\">Shoka 评论推送功能实现</a>。</p>\n<h2 id=\"vercel-配置\"><a class=\"markdownIt-Anchor\" href=\"#vercel-配置\">#</a> Vercel 配置</h2>\n<p>注册  <code>Vercel</code>  完成之后，按照  <code>Waline</code>  的官方教程进行配置。我在这里碰到了一点问题，从  <code>Waline</code>  的入口进入  <code>Vercel</code>  之后，在选择  <code>GitHub</code>  仓库的时无法填写表格，因此无法直接进行 deploy。但是直接选择自己的仓库却又可以。最后只能采用曲线救国的方法，自己 Fork 了仓库，然后再从自己的仓库中进行选择。然而直接 deploy 仓库会报错  <code>This Serverless Function has crashed</code> ，据官方说法，只需要复制  <code>example</code>  文件夹下的内容即可<sup class=\"footnote-ref\"><a href=\"#fn4\" id=\"fnref4\">[4]</a></sup>。</p>\n<p>在  <code>Vercel</code>  的  <code>Settings</code>  中，选择  <code>Environment Variables</code>  添加环境变量，主要是  <code>LEAN_ID</code> ， <code>LEAN_KEY</code> ， <code>LEAN_MASTER_KEY</code>  三个值。</p>\n<div class=\"note info\">\n<p>如果是使用的国内版的  <code>LeanCloud</code> ，还需要额外设置  <code>LEAN_SERVER</code>  变量。</p>\n</div>\n<h3 id=\"添加自定义域名\"><a class=\"markdownIt-Anchor\" href=\"#添加自定义域名\">#</a> 添加自定义域名</h3>\n<p>参照  <code>Waline</code>  教程中的内容，在  <code>Settings</code>  中选择  <code>Domain</code>  进入域名配置页。教程的说明进行配置。</p>\n<p>关于在域名服务器商处添加新的  <code>CNAME</code>  解析记录这一条，由于我是在  <code>Cloudflare</code>  注册的  <code>DNS</code>  服务，因此需要在其中进行配置。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">Type</th>\n<th style=\"text-align:left\">Name</th>\n<th style=\"text-align:left\">Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">CNAME</td>\n<td style=\"text-align:left\">example</td>\n<td style=\"text-align:left\"><a href=\"http://cname.vercel-dns.com\">cname.vercel-dns.com</a></td>\n</tr>\n</tbody>\n</table>\n<table>\n<caption id=\"\" style=\"caption-side: bottom\">域名配置参数表</caption>\n<thead>\n<tr>\n<th style=\"text-align:left\">Type</th>\n<th style=\"text-align:left\">Name</th>\n<th style=\"text-align:left\">Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">CNAME</td>\n<td style=\"text-align:left\">example</td>\n<td style=\"text-align:left\"><a href=\"http://cname.vercel-dns.com\">cname.vercel-dns.com</a></td>\n</tr>\n</tbody>\n</table>\n<p>按我自己的例子，我的域名是  <code>linn-ylz.com</code> ，我选择的用于  <code>Waline</code>  的域名是  <code>comments.linn-ylz.com</code> ，那么在  <code>Cloudflare</code>  配置中添加  <code>CNAME</code>  配置，名称输入  <code>comments</code> ，对应的值为  <code>cname.vercel-dns.com</code> 。</p>\n<p><img loading=\"lazy\" data-src=\"/images/transfer-waline/vercel-cloudflare-config.png\" alt=\"Cloudflare 域名配置\"></p>\n<p>上述配置完成之后可以从  <code>Vercel</code>  中打开网页进行评论测试。</p>\n<h1 id=\"邮件通知配置\"><a class=\"markdownIt-Anchor\" href=\"#邮件通知配置\">#</a> 邮件通知配置</h1>\n<p>这一部分主要参考  <code>Waline</code>  中的<a href=\"https://waline.js.org/guide/server/notification.html\">评论通知</a>教程内容。我选择的是其中的邮件通知服务。教程中列举了以下必须配置的内容：</p>\n<ul>\n<li><code>SMTP_SERVICE</code> : SMTP 邮件发送服务提供商。</li>\n<li><code>SMTP_USER</code> : SMTP 邮件发送服务的用户名，一般为登录邮箱。</li>\n<li><code>SMTP_PASS</code> : SMTP 邮件发送服务的密码，一般为邮箱登录密码，部分邮箱 (例如 163) 是单独的 SMTP 密码。</li>\n<li><code>SITE_NAME</code> : 网站名称，用于在消息中显示。</li>\n<li><code>SITE_URL</code> : 网站地址，用于在消息中显示。</li>\n<li><code>AUTHOR_EMAIL</code> : 博主邮箱，用来接收新评论通知。如果是博主发布的评论则不进行提醒通知。</li>\n</ul>\n<p>以上变量均在  <code>Vercel</code>  中的环境变量设置中添加。由于官方文档惜字如金，所以这里再详细说一下配置的细节。</p>\n<p><code>SMTP_SERVICE</code> 、 <code>SMTP_USER</code> 、 <code>SMTP_PASS</code>  这三项内容是对应发送通知邮件的邮箱。比如我有两个邮箱，一个是 QQ 邮箱，另一个是 Outlook 邮箱，我选择用 QQ 邮箱发送消息到我的 Outlook 邮箱，通知有评论相关的内容到达。那么以上三项内容便需要填写 QQ 邮箱相关的信息。比如 QQ 邮箱的  <code>SMTP_SERVICE</code>  是  <code>QQ</code> ， <code>SMTP_USER</code>  即对应 QQ 邮箱，如  <code>123456789@qq.com</code> 。而  <code>SMTP_PASS</code>  并不是 QQ 邮箱的密码，需要在 QQ 邮箱的 <code>设置</code> 中，找到  <code>账户</code>  选项卡，在  <code>POP3/IMAP/SMTP/Exchange/CardDAV/CalDAV服务</code>  一栏有一个提示，最后有一个生成授权码的可点击链接，点击它之后，会要求你向某个号码发送一条指定内容的短信，发送完成之后会弹窗提示你一个授权码，这个授权码即填写到  <code>SMTP_PASS</code>  中的内容。</p>\n<p><code>SITE_NAME</code>  是消息中显示的网站名称， <code>SITE_URL</code>  则是网站的地址。注意这里填写的地址要包含前面的协议部分，以我自己为例就是  <code>https://linn-ylz.com</code> 。<sup class=\"footnote-ref\"><a href=\"#fn5\" id=\"fnref5\">[5]</a></sup></p>\n<p><code>AUTHOR_EMAIL</code>  就是用于接收评论通知的邮箱。</p>\n<p>以上内容如果均配置正确，那么应该能够正常接收通知了。</p>\n<h1 id=\"修复-leancloud-数据库格式问题\"><a class=\"markdownIt-Anchor\" href=\"#修复-leancloud-数据库格式问题\">#</a> 修复 LeanCloud 数据库格式问题</h1>\n<p>尽管  <code>Waline</code>  也支持  <code>LeanCloud</code> ，但是在读取其中的内容时，因为数据库表格键值的不匹配会在显示上出现一些问题，这点可能和我之前使用的是  <code>MiniValine</code>  有关。</p>\n<h2 id=\"阅读量\"><a class=\"markdownIt-Anchor\" href=\"#阅读量\">#</a> 阅读量</h2>\n<p>首先是阅读量的问题，在  <code>LeanCloud</code>  原来的内容中，存储了之前的网页的访问数量。但是转到  <code>Waline</code>  之后数值却从 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> 开始计算了。在  <code>LeanCloud</code>  后台，也发现和原来的文章不算同一个数据列。经过一番排查没有找到很好的解决办法，因此只能把之前的计数值复制到新的数据项之中，因为文章数量不多，操作起来倒也没费太多时间。</p>\n<h2 id=\"评论\"><a class=\"markdownIt-Anchor\" href=\"#评论\">#</a> 评论</h2>\n<p>在  <code>Vercel</code>  搭建好之后，进入  <code>Waline</code>  的管理平台，发现虽然评论能够正常读取，但是评论的时间显示却存在问题，经排查， <code>Waline</code>  使用的是  <code>insertedAt</code>  列的数据作为评论的发表时间，而之前的数据则是直接使用的  <code>createdAt</code>  列的数据，因此  <code>Waline</code>  读取不到之前评论的发表时间，这里把  <code>createdAt</code>  列的内容复制到  <code>insertedAt</code>  列之后可以正常显示时间了。</p>\n<p>另一个问题是在文章的底部没有显示对应的评论，经排查，是因为之前的评论系统使用的路径是  <code>A/B/</code>  这样的格式，而  <code>Waline</code>  使用的是  <code>/A/B</code>  的格式，相差了一个  <code>/</code>  符号，修正过后，评论能够在文章底部正常显示。</p>\n<h1 id=\"网站访问量\"><a class=\"markdownIt-Anchor\" href=\"#网站访问量\">#</a> 网站访问量</h1>\n<p>网站的访客数量统计使用的是 “不蒜子”，但是其无法进行初始化，因此已经搭建好一段时间的网站的数值便不准确，这里参考<a href=\"https://juejin.cn/post/7035570281414393864\">这篇文章</a>的办法，在主题文件中修改  <code>card_webinfo.pug</code>  文件，在其中添加以下内容：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>script<span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token keyword\">function</span> <span class=\"token function\">checkPv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token keyword\">var</span> init_pv <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>theme<span class=\"token punctuation\">.</span>busuanzi<span class=\"token punctuation\">.</span>init_pv<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token keyword\">var</span> pv <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"busuanzi_value_site_pv\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pv<span class=\"token punctuation\">.</span>innerText <span class=\"token operator\">===</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span>checkPv<span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                pv<span class=\"token punctuation\">.</span>innerText <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>pv<span class=\"token punctuation\">.</span>innerText<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> init_pv</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    script <span class=\"token function\">checkPv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    script<span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">function</span> <span class=\"token function\">checkUv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">var</span> init_uv <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">&#123;</span>theme<span class=\"token punctuation\">.</span>busuanzi<span class=\"token punctuation\">.</span>init_uv<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">var</span> uv <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"busuanzi_value_site_uv\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>uv<span class=\"token punctuation\">.</span>innerText <span class=\"token operator\">===</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span>checkUv<span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                uv<span class=\"token punctuation\">.</span>innerText <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>uv<span class=\"token punctuation\">.</span>innerText<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> init_uv</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    script <span class=\"token function\">checkUv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h1 id=\"在-shoka-中使用-waline\"><a class=\"markdownIt-Anchor\" href=\"#在-shoka-中使用-waline\">#</a> 在 Shoka 中使用 Waline</h1>\n<p>如文章开头所述，使用了一个小姐姐提供的方法<sup class=\"footnote-ref\"><a href=\"#fn1\" id=\"fnref1:1\">[1:1]</a></sup>，成功将评论系统更换为了  <code>Waline</code> 。虽然如此，但是还存在一些问题。</p>\n<p>首先是和  <code>MiniValine</code>  的冲突问题，原来博客中的最近评论和文章浏览量统计是通过  <code>MiniValine</code>  的功能实现的，更换为  <code>Waline</code>  之后便失效了。虽然  <code>Waline</code>  也有提供这些功能，但是由于本人对于前端实在是苦手，因此最后也只是解决了最近评论的问题。文章浏览量统计在很多时候还是不能正常显示，只有通过刷新网页才能够正常显示，最后还是妥协成现在这个状况了。</p>\n<h2 id=\"最近评论问题\"><a class=\"markdownIt-Anchor\" href=\"#最近评论问题\">#</a> 最近评论问题</h2>\n<p>对于最近评论，我采用的办法是在网页 DOM 结构树生成完成之后，通过  <code>Waline</code>  的 API 接口进行查询，然后输出到网页中。这里的代码参考的是刚才提到的小姐姐的  <code>GitHub</code>  中的相关文件<sup class=\"footnote-ref\"><a href=\"#fn6\" id=\"fnref6\">[6]</a></sup>。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getRecentComments</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"getRecentComments triggered.\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">CONFIG</span><span class=\"token punctuation\">.</span>waline<span class=\"token punctuation\">.</span>serverURL<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">var</span> t <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".waline-recent-comments\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function\">renderTime</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">date</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">let</span> myDate <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toJSON</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>myDate<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">8</span> <span class=\"token operator\">*</span> <span class=\"token number\">3600</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toISOString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">T</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\.[\\d]&#123;3&#125;Z</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function\">formatTime</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">time</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">let</span> d <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>time <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1000</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">let</span> h <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>time <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1000</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">let</span> m <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>time <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1000</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">let</span> s <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>time <span class=\"token operator\">/</span> <span class=\"token number\">1000</span> <span class=\"token operator\">%</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>d <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">return</span> d <span class=\"token operator\">+</span> <span class=\"token string\">' 天前'</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>h <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">return</span> h <span class=\"token operator\">+</span> <span class=\"token string\">' 小时前'</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>m <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token keyword\">return</span> m <span class=\"token operator\">+</span> <span class=\"token string\">' 分钟前'</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token keyword\">return</span> s <span class=\"token operator\">+</span> <span class=\"token string\">' 秒钟前'</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">let</span> str <span class=\"token operator\">=</span> <span class=\"token string\">' @ '</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">let</span> reg <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">&lt;.*?></span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">ig</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">let</span> date <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token keyword\">let</span> url <span class=\"token operator\">=</span> <span class=\"token constant\">CONFIG</span><span class=\"token punctuation\">.</span>waline<span class=\"token punctuation\">.</span>serverURL<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">let</span> count <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">var</span> t <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".waline-recent-comments\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>t <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>t<span class=\"token punctuation\">.</span>classList<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"loaded\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"load recent comments\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>url<span class=\"token operator\">+</span><span class=\"token string\">'/comment?type=recent&amp;count='</span><span class=\"token operator\">+</span>count<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span> <span class=\"token operator\">=></span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            <span class=\"token keyword\">let</span> arr <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span> <span class=\"token operator\">=></span> item<span class=\"token punctuation\">.</span>pid <span class=\"token operator\">!==</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            <span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> arr<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"total \"</span> <span class=\"token operator\">+</span> i <span class=\"token operator\">+</span> <span class=\"token string\">\" comments\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> r <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> o <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> o <span class=\"token operator\">&lt;</span> i<span class=\"token punctuation\">;</span> o<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>                <span class=\"token keyword\">let</span> comment <span class=\"token operator\">=</span> arr<span class=\"token punctuation\">[</span>o<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>comment<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span>reg<span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>                <span class=\"token keyword\">let</span> gap <span class=\"token operator\">=</span> <span class=\"token function\">formatTime</span><span class=\"token punctuation\">(</span>date <span class=\"token operator\">-</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token function\">renderTime</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">[</span>o<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>createdAt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>                r <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;li class=\"item\">&lt;a href=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>arr<span class=\"token punctuation\">[</span>o<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>url <span class=\"token operator\">+</span> <span class=\"token string\">'#'</span> <span class=\"token operator\">+</span> arr<span class=\"token punctuation\">[</span>o<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>objectId<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">\"></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>                    &lt;span class=\"breadcrumb\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>arr<span class=\"token punctuation\">[</span>o<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>nick <span class=\"token operator\">+</span> str <span class=\"token operator\">+</span> gap<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">&lt;/span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>                    &lt;span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>comment<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">&lt;/span>&lt;/a>&lt;/li></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>                t<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> r<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>                t<span class=\"token punctuation\">.</span>classList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"loaded\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"47\"></td><td><pre>                <span class=\"token comment\">// e.config.pjax &amp;&amp; e.config.pjax.refresh(t)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span>console<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>上述内容我添加在  <code>source/js/_app/pjax.js</code>  文件中，直接添加在最底部即可。上述函数添加后，再添加一个事件监听器：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'DOMContentLoaded'</span><span class=\"token punctuation\">,</span> getRecentComments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>该监听器表示在 DOM 资源生成完毕之后，执行该函数进行查询。</p>\n<h2 id=\"文章浏览量统计\"><a class=\"markdownIt-Anchor\" href=\"#文章浏览量统计\">#</a> 文章浏览量统计</h2>\n<p>文章浏览量统计和最近评论的解决思路类似，也是在 DOM 结构树生成完毕之后，进行查询。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getPageView</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"getPageView triggered.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">CONFIG</span><span class=\"token punctuation\">.</span>waline<span class=\"token punctuation\">.</span>serverURL<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">var</span> t <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".leancloud-visitors-count\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">let</span> path <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>pathname<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">let</span> url <span class=\"token operator\">=</span> <span class=\"token constant\">CONFIG</span><span class=\"token punctuation\">.</span>waline<span class=\"token punctuation\">.</span>serverURL<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Load page views\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Current page path: \"</span> <span class=\"token operator\">+</span> path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token keyword\">let</span> https <span class=\"token operator\">=</span> url<span class=\"token operator\">+</span><span class=\"token string\">'/article?path='</span><span class=\"token operator\">+</span>path<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>https<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span> <span class=\"token operator\">=></span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Pageview: \"</span> <span class=\"token operator\">+</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>          t<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> data<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span>console<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'DOMContentLoaded'</span><span class=\"token punctuation\">,</span> getPageView<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>除此之外，还需要修改  <code>layout/_partials/post/footer.njk</code>  这一文件中的内容。首先把  <code>if theme.valine.appId and theme.valine.appKey and theme.valine.visitor</code>  这一语句修改成  <code>if theme.waline.serverURL</code> ，否则在没有  <code>Valine</code>  配置的情况下，文章浏览量的元素不会显示。然后把  <code>&lt;span id=&quot;&#123;&#123; page.path | replace('index.html', '') &#125;&#125;&quot;...&quot;&gt;</code>  这个标签中的内容修改掉，比如我修改成了  <code>&lt;span class=&quot;item&quot;&gt;</code> 。这里之所以把  <code>&lt;span&gt;</code>  标签中的内容修改掉是因为我发现如果保留该标签，该数值一直是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>，应该是会被某个脚本执行的内容覆盖掉。具体原理还不明确。</p>\n<p>但是这个方法存在的问题是，除非刷新网页，否则浏览数据不会正常显示。</p>\n<p>尽管花了很多时间尝试别的方法，但是最后还是没有彻底解决。如果有哪位前端大佬能够不吝赐教，感激不尽。</p>\n<h2 id=\"评论系统样式问题\"><a class=\"markdownIt-Anchor\" href=\"#评论系统样式问题\">#</a> 评论系统样式问题</h2>\n<p>由于  <code>Waline</code>  系统的默认样式和  <code>Shoka</code>  不是非常搭配，因此仍然参考小姐姐的教程<sup class=\"footnote-ref\"><a href=\"#fn1\" id=\"fnref1:2\">[1:2]</a></sup>进行了配置，但是发现并没有生效。经过排查是因为原来主题中存在的  <code>MiniValine</code>  相关的样式覆盖了配置的样式。最好把相关的  <code>MiniValine</code>  的内容全部注释掉。</p>\n<h1 id=\"终\"><a class=\"markdownIt-Anchor\" href=\"#终\">#</a> 终</h1>\n<p>花了几天总算是把博客主题折腾好了。虽然花了不少功夫，<s>还额外给网页增加了几十次浏览量。</s> 还有些问题没有完全解决，但是能够保住这个主题还是很高兴的。<s>只要能保住太原，他要多少我给多少！</s></p>\n<hr class=\"footnotes-sep\">\n<section class=\"footnotes\">\n<ol class=\"footnotes-list\">\n<li id=\"fn1\" class=\"footnote-item\"><p><a href=\"https://ry.mk/2022/03/06/zai-shoka-zhong-tian-zeng-waline-ping-lun-xi-tong-bing-zi-ding-yi-yang-shi\">在 Shoka 中添增 Waline 评论系统并自定义样式</a> <a href=\"#fnref1\" class=\"footnote-backref\">↩︎</a> <a href=\"#fnref1:1\" class=\"footnote-backref\">↩︎</a> <a href=\"#fnref1:2\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn2\" class=\"footnote-item\"><p><a href=\"https://oldtang.com/2420.html#%E4%B8%89%E3%80%81%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%B9%B6%E8%A7%A3%E6%9E%90%E5%9F%9F%E5%90%8D\">Dynadot 网站注册账户、购买域名、支付宝付款、解析域名教程</a> <a href=\"#fnref2\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn3\" class=\"footnote-item\"><p><a href=\"https://www.bandwagonhost.net/5986.html\">使用 Cloudflare 免费 DNS 服务器解析域名到搬瓦工 VPS 主机建站教程</a> <a href=\"#fnref3\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn4\" class=\"footnote-item\"><p><a href=\"https://github.com/walinejs/waline/discussions/1098\">Vercel 重新部署后 Serverless Function has crashed</a> <a href=\"#fnref4\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn5\" class=\"footnote-item\"><p><a href=\"https://github.com/walinejs/waline/issues/480\">[BUG] 配置邮件通知成功后，无法定位到评论所在的具体文章</a> <a href=\"#fnref5\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn6\" class=\"footnote-item\"><p><a href=\"https://github.com/WakabaYu/WakabaYu.github.io/blob/master/js/rcomment.js\">最近评论获取</a> <a href=\"#fnref6\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n</ol>\n</section>\n",
            "tags": [
                "Hexo",
                "Valine",
                "Waline"
            ]
        },
        {
            "id": "https://linn-ylz.com/Hexo/blog-comment-push/",
            "url": "https://linn-ylz.com/Hexo/blog-comment-push/",
            "title": "Shoka 评论推送功能实现",
            "date_published": "2021-09-07T06:13:34.000Z",
            "content_html": "<h1 id=\"评论推送功能\"><a class=\"markdownIt-Anchor\" href=\"#评论推送功能\">#</a> 评论推送功能</h1>\n<p><code>Valine</code>  的评论功能很强大，但是当有人进行评论时，并不会自动推送消息。如果想要在收到新的评论时获得推送，需要基于  <code>Leancloud</code>  来进行配置。 <code>Shoka</code>  主题的作者推荐使用  <code>Valine-Admin</code>  来实现评论管理及消息推送功能，项目地址可以<a href=\"https://github.com/DesertsP/Valine-Admin\">点击此链接</a>。</p>\n<p><code>Valine-Admin</code>  作者提供的配置教程有些地方存在一些不清楚的地方，下面记录一下我在配置过程中遇到的问题及解决方案，可以配合  <code>Valine-Admin</code>  的配置教程阅读。</p>\n<h2 id=\"leancloud-配置\"><a class=\"markdownIt-Anchor\" href=\"#leancloud-配置\">#</a> Leancloud 配置</h2>\n<p>关于  <code>Leancloud</code> ，这里推荐使用国际版，因为国内版目前无法免费创建二级域名，如果需要自己创建域名的话还需要进行备案，比较麻烦。</p>\n<p>一些基本配置可以参考  <code>Valine-Admin</code>  <a href=\"https://github.com/DesertsP/Valine-Admin\">教程</a>，这里说一些比较容易出问题的地方。</p>\n<h3 id=\"fork-代码\"><a class=\"markdownIt-Anchor\" href=\"#fork-代码\">#</a> fork 代码</h3>\n<p>首先需要 fork  <code>Valine-Admin</code>  作者的  <code>GitHub</code>  仓库，即上文链接中的仓库，只有完成这一步之后才能部署成功。在此步完成之后，参考教程内容配置环境变量。</p>\n<h3 id=\"site_url\"><a class=\"markdownIt-Anchor\" href=\"#site_url\">#</a>  <code>SITE_URL</code></h3>\n<p>关于  <code>SITE_URL</code> ， <code>Valine-Admin</code>  作者说的是不需要最后的  <code>/</code>  符号，但是  <code>Shoka</code>  主题的作者却说需要。这里我在网址的最后添加了  <code>/</code>  符号，目前没有问题。如果碰到报错的话，可以两种方式都进行尝试。</p>\n<h3 id=\"二级域名配置\"><a class=\"markdownIt-Anchor\" href=\"#二级域名配置\">#</a> 二级域名配置</h3>\n<p>在配置环境变量的下方，有名为  <code>共享域名</code>  的配置，这里可以自己定义，使用一个容易记忆的名称即可。在填写  <code>ADMIN_URL</code>  时，需要注意在域名前添加  <code>stg</code>  前缀。例如，我自己定义的域名名称为  <code>linn-blog</code> ，此时完整的域名包含了固定的后缀  <code>.avosapps.us</code> ，即完整的域名是  <code>https://linn-blog.avosapps.us</code> 。而  <code>ADMIN_URL</code>  中需要填写  <code>https://stg-linn-blog.avosapps.us</code> 。</p>\n<h3 id=\"邮箱配置\"><a class=\"markdownIt-Anchor\" href=\"#邮箱配置\">#</a> 邮箱配置</h3>\n<p>邮箱我原本预期使用  <code>Outlook</code>  邮箱，但是在认证上出现了一些问题，后来改用了  <code>QQ</code>  邮箱。需要注意的是  <code>SMTP_PASS</code>  这一栏不是直接填写  <code>QQ</code>  邮箱的密码，而是需要填写在  <code>QQ</code>  邮箱的设置中获取的  <code>TOKEN</code> 。</p>\n<p>进入  <code>QQ</code>  邮箱后，点击  <code>设置-账户</code> ，找到  <code>POP3/IMAP/SMTP/Exchange/CardDAV/CalDAV服务</code>  一栏，选择开启  <code>IMAP/SMTP服务</code> ，经过验证后，会获得一个  <code>TOKEN</code> ，将其内容复制到  <code>SMTP_PASS</code>  中填写即可。</p>\n<h3 id=\"登录后台\"><a class=\"markdownIt-Anchor\" href=\"#登录后台\">#</a> 登录后台</h3>\n<p>后台网址和配置的二级域名有关。例如，我需要登录  <code>https://linn-blog.avosapps.us/sign-up</code> ，这里不需要添加  <code>stg-</code>  的前缀。登录时输入的账号密码是对应邮箱的账号和密码。对于  <code>QQ</code>  邮箱而言，是登录  <code>QQ</code>  邮箱时输入的主密码，不是设置的独立密码。</p>\n<h2 id=\"定时唤醒失败问题\"><a class=\"markdownIt-Anchor\" href=\"#定时唤醒失败问题\">#</a> 定时唤醒失败问题</h2>\n<div class=\"note warning\">\n<p>下列代码会遇到跨域问题，现在采用别的方法解决。参见上文方法。</p>\n</div>\n<p>由于  <code>Leancloud</code>  免费版部署的服务会自动休眠，因此需要定时唤醒。在之前这个功能还能正常使用，但是目前在定时启动时会碰到下面的报错：</p>\n<div class=\"note primary\">\n<p><code>因流控原因，通过定时任务唤醒体验版实例失败，建议升级至标准版云引擎实例避免休眠</code></p>\n</div>\n<p>关于这个问题，我搜索到了几篇博文 <sup class=\"footnote-ref\"><a href=\"#fn1\" id=\"fnref1\">[1]</a></sup> <sup class=\"footnote-ref\"><a href=\"#fn2\" id=\"fnref2\">[2]</a></sup>。这里我采用的是第二个链接中提供的方法 —— 当有人访问博客时，访问后台以唤醒部署的服务，详情可以参考第二个链接的内容。</p>\n<p>对于  <code>Shoka</code>  主题而言，作者使用了自己修改过的  <code>MiniValine</code> ，其初始化代码在主题下的  <code>pjax.js</code>  文件中，我在其初始化之后的位置添加了代码，代码参考了 <sup class=\"footnote-ref\"><a href=\"#fn2\" id=\"fnref2:1\">[2:1]</a></sup> 的内容：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">new</span> <span class=\"token class-name\">MiniValine</span><span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\">// 该行是原来的初始化代码</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// Wakeup Leancloud</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Try to wakeup Leancloud\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">var</span> engine <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span>cookie<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">(?:(?:^|.*;\\s*)engine\\s*\\=\\s*([^;]*).*$)|^.*$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"$1\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>engine <span class=\"token operator\">!=</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://quan.suning.com/getSysTime.do'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">date</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token comment\">// var hours = new Date(date.sysTime2).getHours();</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token comment\">// if(hours>7 &amp;&amp; hours&lt;23)&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> <span class=\"token string\">'https://linn-blog.avosapps.us'</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 注意不要添加 stg 前缀</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>status<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">var</span> result <span class=\"token operator\">=</span> url <span class=\"token operator\">+</span> <span class=\"token string\">\" Status：\"</span> <span class=\"token operator\">+</span> html<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">var</span> exp <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span>sysTime2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    exp<span class=\"token punctuation\">.</span><span class=\"token function\">setTime</span><span class=\"token punctuation\">(</span>exp<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">10</span><span class=\"token operator\">*</span><span class=\"token number\">60</span><span class=\"token operator\">*</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 10 分钟内刷新不再重新请求</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    document<span class=\"token punctuation\">.</span>cookie <span class=\"token operator\">=</span> <span class=\"token string\">\"engine=1;path=/;expires=\"</span><span class=\"token operator\">+</span> exp<span class=\"token punctuation\">.</span><span class=\"token function\">toGMTString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token comment\">// &#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Cookie not expired. No need to wakeup.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>原作者的代码是在某个时间段中有人访问时才进行唤醒，我这里修改成了任意时间段都可以唤醒。另外  <code>cookie</code>  的失效间隔被我修改成了 10 分钟。</p>\n<h3 id=\"更新\"><a class=\"markdownIt-Anchor\" href=\"#更新\">#</a> 更新</h3>\n<p>本文的方法后来在访问  <code>https://quan.suning.com/getSysTime.do</code>  出现了新的跨域问题，我重新修改了代码。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">wakeUpLeanCloud</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Try to wakeup Leancloud\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> <span class=\"token string\">'https://linn-blog.avosapps.us'</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 注意不要添加 stg 前缀</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>status<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token keyword\">var</span> result <span class=\"token operator\">=</span> url <span class=\"token operator\">+</span> <span class=\"token string\">\" Status：\"</span> <span class=\"token operator\">+</span> html<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'DOMContentLoaded'</span><span class=\"token punctuation\">,</span> wakeUpLeanCloud<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hashchange'</span><span class=\"token punctuation\">,</span> wakeUpLeanCloud<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这次也就懒得检查  <code>cookie</code>  了，每当有人访问时直接唤醒。</p>\n<p>这篇<a href=\"https://plusye.com/posts/e04ca062.html\">博客</a> 提供了一种新的方法，使用 <a href=\"https://uptimerobot.com/\">UptimeRobot</a> 定时访问  <code>LeanCloud</code>  的后台。我设置了一小时的访问，这下应该能够覆盖绝大多数评论的情况了。</p>\n<h3 id=\"跨域问题解决\"><a class=\"markdownIt-Anchor\" href=\"#跨域问题解决\">#</a> 跨域问题解决</h3>\n<p>唤醒的脚本代码在运行时会遇到跨域访问的问题，这里我参考了 <sup class=\"footnote-ref\"><a href=\"#fn2\" id=\"fnref2:2\">[2:2]</a></sup> 这篇博文的做法，修改了  <code>Valine-Admin</code>  中的代码，使其能够支持跨域功能。具体可以作者提供的  <code>GitHub</code>  仓库<a href=\"https://github.com/track23/Valine-Admin\">链接</a>，查看  <code>设置允许跨域</code>  的这一个  <code>commit</code> 。在设置之后，注意使用  <code>npm install cors --save</code>  命令，更新  <code>package.json</code>  和  <code>package-lock.json</code> ，否则  <code>Leancloud</code>  部署时可能会报错。</p>\n<h1 id=\"结语\"><a class=\"markdownIt-Anchor\" href=\"#结语\">#</a> 结语</h1>\n<p>通过上述的配置及后续的测试，目前已经基本能够满足我当前的需求。不得不吐槽前端和前后端交互的代码及调试是真的非常非常麻烦，这个功能也是花费了好几天琢磨才做出了最终的效果。后续应该没有其他需要再折腾的功能了，可以把精力投入到其他内容上去。关于  <code>Shoka</code>  主题的配置基本到此告一段落。</p>\n<hr class=\"footnotes-sep\">\n<section class=\"footnotes\">\n<ol class=\"footnotes-list\">\n<li id=\"fn1\" class=\"footnote-item\"><p><a href=\"https://duter2016.github.io/2020/06/09/%E8%A7%A3%E5%86%B3LeanCLoud%E5%AE%9A%E6%97%B6%E5%94%A4%E9%86%92%E5%A4%B1%E8%B4%A5%E7%9A%84%E6%B5%81%E6%8E%A7%E9%97%AE%E9%A2%98/\">解决 LeanCLoud 定时唤醒失败的流控问题</a> <a href=\"#fnref1\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn2\" class=\"footnote-item\"><p><a href=\"https://crosschannel.cc/daily/valine-admin-autoAwaken.html\">解决 valine-admin 云引擎唤醒失败</a> <a href=\"#fnref2\" class=\"footnote-backref\">↩︎</a> <a href=\"#fnref2:1\" class=\"footnote-backref\">↩︎</a> <a href=\"#fnref2:2\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n</ol>\n</section>\n",
            "tags": [
                "Hexo"
            ]
        },
        {
            "id": "https://linn-ylz.com/Hexo/blog-search-config/",
            "url": "https://linn-ylz.com/Hexo/blog-search-config/",
            "title": "Shoka 主题搜索功能修改",
            "date_published": "2021-09-03T12:12:42.000Z",
            "content_html": "<h1 id=\"shoka-主题的搜索功能配置\"><a class=\"markdownIt-Anchor\" href=\"#shoka-主题的搜索功能配置\">#</a>  <code>Shoka</code>  主题的搜索功能配置</h1>\n<p><code>Shoka</code>  主题的搜索功能是基于 <a href=\"https://www.algolia.com\"> <code>Algolia</code> </a> 实现的，由于  <code>Algolia</code>  每个月有搜索次数限制，并且每次搜索时需要访问其服务器进行查询，修改文章后还需要执行  <code>hexo algolia</code>  的指令，操作起来相对繁琐，因此我考虑更换为基于本地文件搜索的形式实现搜索功能。这一部分的实现主要参考了<a href=\"https://github.com/theme-next/hexo-theme-next\">  <code>Next</code>  主题</a>的相关代码。</p>\n<h2 id=\"若干主要的代码文件\"><a class=\"markdownIt-Anchor\" href=\"#若干主要的代码文件\">#</a> 若干主要的代码文件</h2>\n<p><code>Shoka</code>  主题与搜索功能相关的代码主要在  <code>shoka/source/js/_app/page.js</code> ， <code>shoka/source/js/_app/pjax.js</code> ， <code>shoka/scripts/generaters/script.js</code>  和  <code>shoka/source/css/_common/components/third-party/search.styl</code>  这四个文件中。其中  <code>page.js</code> ， <code>pjax.js</code>  和  <code>script.js</code>  是功能实现的相关代码， <code>search.styl</code>  则是一些样式设计的代码。</p>\n<h2 id=\"algolia-配置的主要代码\"><a class=\"markdownIt-Anchor\" href=\"#algolia-配置的主要代码\">#</a>  <code>Algolia</code>  配置的主要代码</h2>\n<p><code>Shoka</code>  主题通过在  <code>pjax.js</code>  中调用  <code>algoliasearch</code>  函数来实现搜索功能，我自己的修改则是将其替换为了自己实现的  <code>localsearch</code>  函数，这些函数的实现主要在  <code>page.js</code>  中。 <code>script.js</code>  中有少量和配置选项相关的代码。</p>\n<p>基于  <code>Algolia</code>  实现的搜索功能主要利用  <code>search.addWidgets</code>  来添加和搜索功能相关的  <code>Widgets</code> ：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>search<span class=\"token punctuation\">.</span><span class=\"token function\">addWidgets</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    instantsearch<span class=\"token punctuation\">.</span>widgets<span class=\"token punctuation\">.</span><span class=\"token function\">configure</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>      <span class=\"token literal-property property\">hitsPerPage</span><span class=\"token operator\">:</span> <span class=\"token constant\">CONFIG</span><span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">.</span>hits<span class=\"token punctuation\">.</span>per_page <span class=\"token operator\">||</span> <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    instantsearch<span class=\"token punctuation\">.</span>widgets<span class=\"token punctuation\">.</span><span class=\"token function\">searchBox</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token literal-property property\">container</span>           <span class=\"token operator\">:</span> <span class=\"token string\">'.search-input-container'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token literal-property property\">placeholder</span>         <span class=\"token operator\">:</span> <span class=\"token constant\">LOCAL</span><span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">.</span>placeholder<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token literal-property property\">searchOnEnterKeyPressOnly</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\">// Only search when press enter key</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token comment\">// Hide default icons of algolia search</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token literal-property property\">showReset</span>           <span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token literal-property property\">showSubmit</span>          <span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token literal-property property\">showLoadingIndicator</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token literal-property property\">cssClasses</span>          <span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token literal-property property\">input</span><span class=\"token operator\">:</span> <span class=\"token string\">'search-input'</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    instantsearch<span class=\"token punctuation\">.</span>widgets<span class=\"token punctuation\">.</span><span class=\"token function\">stats</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token literal-property property\">container</span><span class=\"token operator\">:</span> <span class=\"token string\">'#search-stats'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token literal-property property\">templates</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token function-variable function\">text</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>          <span class=\"token keyword\">var</span> stats <span class=\"token operator\">=</span> <span class=\"token constant\">LOCAL</span><span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">.</span>stats</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\$\\&#123;hits&#125;</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">.</span>nbHits<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\$\\&#123;time&#125;</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">.</span>processingTimeMS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>          <span class=\"token keyword\">return</span> stats <span class=\"token operator\">+</span> <span class=\"token string\">'&lt;span class=\"algolia-powered\">&lt;/span>&lt;hr>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    instantsearch<span class=\"token punctuation\">.</span>widgets<span class=\"token punctuation\">.</span><span class=\"token function\">hits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      <span class=\"token literal-property property\">container</span><span class=\"token operator\">:</span> <span class=\"token string\">'#search-hits'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      <span class=\"token literal-property property\">templates</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token function-variable function\">item</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>          <span class=\"token keyword\">var</span> cats <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>categories <span class=\"token operator\">?</span> <span class=\"token string\">'&lt;span>'</span><span class=\"token operator\">+</span>data<span class=\"token punctuation\">.</span>categories<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;i class=\"ic i-angle-right\">&lt;/i>'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">'&lt;/span>'</span> <span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>          <span class=\"token keyword\">return</span> <span class=\"token string\">'&lt;a href=\"'</span> <span class=\"token operator\">+</span> <span class=\"token constant\">CONFIG</span><span class=\"token punctuation\">.</span>root <span class=\"token operator\">+</span> data<span class=\"token punctuation\">.</span>path <span class=\"token operator\">+</span><span class=\"token string\">'\">'</span> <span class=\"token operator\">+</span> cats <span class=\"token operator\">+</span> </pre></td></tr><tr><td data-num=\"38\"></td><td><pre>          <span class=\"token string\">'&lt;b>'</span> <span class=\"token operator\">+</span> data<span class=\"token punctuation\">.</span>_highlightResult<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">.</span>value <span class=\"token operator\">+</span> <span class=\"token string\">'&lt;/b>&lt;br>'</span> <span class=\"token operator\">+</span> </pre></td></tr><tr><td data-num=\"39\"></td><td><pre>          data<span class=\"token punctuation\">.</span>_snippetResult<span class=\"token punctuation\">.</span>contentStrip<span class=\"token punctuation\">.</span>value <span class=\"token operator\">+</span> <span class=\"token string\">'&lt;br>( 匹配字词 : '</span> <span class=\"token operator\">+</span> </pre></td></tr><tr><td data-num=\"40\"></td><td><pre>          data<span class=\"token punctuation\">.</span>_highlightResult<span class=\"token punctuation\">.</span>contentStrip<span class=\"token punctuation\">.</span>matchedWords <span class=\"token operator\">+</span> <span class=\"token string\">' ) | ( 匹配等级 : '</span> <span class=\"token operator\">+</span> </pre></td></tr><tr><td data-num=\"41\"></td><td><pre>          data<span class=\"token punctuation\">.</span>_highlightResult<span class=\"token punctuation\">.</span>contentStrip<span class=\"token punctuation\">.</span>matchLevel <span class=\"token operator\">+</span> <span class=\"token string\">' )'</span> <span class=\"token operator\">+</span> <span class=\"token string\">'&lt;/a>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token function-variable function\">empty</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>          <span class=\"token keyword\">return</span> <span class=\"token string\">'&lt;div id=\"hits-empty\">'</span><span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>              <span class=\"token constant\">LOCAL</span><span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">.</span>empty<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\$\\&#123;query&#125;</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            <span class=\"token string\">'&lt;/div>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>      <span class=\"token literal-property property\">cssClasses</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token literal-property property\">item</span><span class=\"token operator\">:</span> <span class=\"token string\">'item'</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    instantsearch<span class=\"token punctuation\">.</span>widgets<span class=\"token punctuation\">.</span><span class=\"token function\">pagination</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>      <span class=\"token literal-property property\">container</span><span class=\"token operator\">:</span> <span class=\"token string\">'#search-pagination'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>      <span class=\"token literal-property property\">scrollTo</span> <span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>      <span class=\"token literal-property property\">showFirst</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>      <span class=\"token literal-property property\">showLast</span> <span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>      <span class=\"token literal-property property\">templates</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token literal-property property\">first</span>   <span class=\"token operator\">:</span> <span class=\"token string\">'&lt;i class=\"ic i-angle-double-left\">&lt;/i>'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        <span class=\"token literal-property property\">last</span>    <span class=\"token operator\">:</span> <span class=\"token string\">'&lt;i class=\"ic i-angle-double-right\">&lt;/i>'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token literal-property property\">previous</span><span class=\"token operator\">:</span> <span class=\"token string\">'&lt;i class=\"ic i-angle-left\">&lt;/i>'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>        <span class=\"token literal-property property\">next</span>    <span class=\"token operator\">:</span> <span class=\"token string\">'&lt;i class=\"ic i-angle-right\">&lt;/i>'</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>      <span class=\"token literal-property property\">cssClasses</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>        <span class=\"token literal-property property\">root</span>        <span class=\"token operator\">:</span> <span class=\"token string\">'pagination'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>        <span class=\"token literal-property property\">item</span>        <span class=\"token operator\">:</span> <span class=\"token string\">'pagination-item'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>        <span class=\"token literal-property property\">link</span>        <span class=\"token operator\">:</span> <span class=\"token string\">'page-number'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>        <span class=\"token literal-property property\">selectedItem</span><span class=\"token operator\">:</span> <span class=\"token string\">'current'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>        <span class=\"token literal-property property\">disabledItem</span><span class=\"token operator\">:</span> <span class=\"token string\">'disabled-item'</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这部分代码配置了相关  <code>Widgets</code>  的设置选项，制定了各个对象的展示样式。其中的  <code>HTML</code>  相关代码可以用于之后的本地搜索实现，使得搜索界面的风格和原本的主题保持一致。</p>\n<h2 id=\"参考-hexo-的-next-主题修改-algolia-为本地搜索\"><a class=\"markdownIt-Anchor\" href=\"#参考-hexo-的-next-主题修改-algolia-为本地搜索\">#</a> 参考 Hexo 的 Next 主题修改  <code>Algolia</code>  为本地搜索</h2>\n<p><code>localsearch</code>  函数的实现主要<s>参考</s>复制了  <code>Next</code>  主题 <a href=\"https://github.com/theme-next/hexo-theme-next/blob/d24c48efb1ff1182b23926a3835e350f9c3ab6eb/source/js/local-search.js\"> <code>local-search.js</code> </a> 的一些代码。</p>\n<p>这些函数中主要需要关注  <code>inputEventFunction</code> ，它用于处理搜索框的输入，并返回搜索结果对应的  <code>HTML</code>  代码。搜索结果的样式依旧使用原本  <code>Shoka</code>  主题的样式，不做大的修改。</p>\n<p>原本的  <code>Shoka</code>  主题只会显示关键词所在的文章标题，这里我在每个文章的标题下方增加显示了每篇文章中前 10 个匹配的关键词所在位置的上下文。</p>\n<p>由于  <code>localsearch</code>  的功能是基于  <code>https://github.com/theme-next/hexo-generator-searchdb</code>  插件实现的，这里需要在配置文件中增加对应的选项：</p>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">search</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">enable</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> search.json <span class=\"token comment\"># search.xml</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token key atrule\">field</span><span class=\"token punctuation\">:</span> post</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token key atrule\">format</span><span class=\"token punctuation\">:</span> html</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token key atrule\">limit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10000</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token key atrule\">content</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token key atrule\">unescape</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token key atrule\">preload</span><span class=\"token punctuation\">:</span>  <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token key atrule\">trigger</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"auto\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token key atrule\">top_n_per_article</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span></pre></td></tr></table></figure><p>上述的选项是我把插件和  <code>Next</code>  主题的配置项混合在一起列出的，具体的含义可以参看插件或者  <code>Next</code>  主题的相关说明文档。</p>\n<p><code>localsearch</code>  函数在  <code>page.js</code>  中：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">localSearch</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">pjax</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token comment\">// 参考 hexo next 主题的配置方法</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token comment\">// 参考 https://qiuyiwu.github.io/2019/01/25/Hexo-LocalSearch/ 博文</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CONFIG</span><span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CONFIG</span><span class=\"token punctuation\">.</span>search <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">return</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>siteSearch<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    siteSearch <span class=\"token operator\">=</span> <span class=\"token constant\">BODY</span><span class=\"token punctuation\">.</span><span class=\"token function\">createChild</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> <span class=\"token string\">'search'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token literal-property property\">innerHTML</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;div class=\"inner\"></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                    &lt;div class=\"header\"></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                      &lt;span class=\"icon\"></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                        &lt;i class=\"ic i-search\"></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                        &lt;/i></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                      &lt;/span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                      &lt;div class=\"search-input-container\"></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                      &lt;input  class=\"search-input\"</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                              autocomplete=\"off\"</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                              placeholder=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span><span class=\"token constant\">LOCAL</span><span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">.</span>placeholder<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">\" </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                              spellcheck=\"false\"</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                              type=\"text\" </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                              id=\"local-search-input\"></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                      &lt;/div></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                        &lt;span class=\"close-btn\"></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                          &lt;i class=\"ic i-times-circle\"></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                          &lt;/i></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                        &lt;/span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                      &lt;/div></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                      &lt;div class=\"results\"></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                        &lt;div class=\"inner\"></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                        &lt;div id=\"search-stats\"></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>                        &lt;/div></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>                        &lt;div id=\"search-hits\"></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>                        &lt;/div></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                        &lt;div id=\"search-pagination\"></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>                        &lt;/div></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                      &lt;/div></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>                    &lt;/div></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>                  &lt;/div></span><span class=\"token template-punctuation string\">`</span></span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"44\"></td><td><pre>  <span class=\"token keyword\">let</span> isFetched <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>  <span class=\"token keyword\">let</span> datas<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>  <span class=\"token keyword\">let</span> isXml <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>  <span class=\"token comment\">// search DB path</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>  <span class=\"token keyword\">let</span> searchPath <span class=\"token operator\">=</span> <span class=\"token constant\">CONFIG</span><span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>searchPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>searchPath<span class=\"token punctuation\">.</span>length <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    searchPath <span class=\"token operator\">=</span> <span class=\"token string\">'search.xml'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>searchPath<span class=\"token punctuation\">.</span><span class=\"token function\">endsWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">'json'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    isXml <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>  <span class=\"token keyword\">const</span> input <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.search-input'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// document.querySelector('.search-input');</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>  <span class=\"token comment\">// console.log(input);</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>  <span class=\"token keyword\">const</span> resultContent <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'search-result'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>  <span class=\"token comment\">// console.log(resultContent);</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getIndexByWord</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">word<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">,</span> caseSensitive</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">CONFIG</span><span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">.</span>unescape<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>      <span class=\"token keyword\">let</span> div <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>      div<span class=\"token punctuation\">.</span>innerText <span class=\"token operator\">=</span> word<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>      word <span class=\"token operator\">=</span> div<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    <span class=\"token keyword\">let</span> wordLen <span class=\"token operator\">=</span> word<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>wordLen <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    <span class=\"token keyword\">let</span> startPosition <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>    <span class=\"token keyword\">let</span> position <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    <span class=\"token keyword\">let</span> index <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>caseSensitive<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>      text <span class=\"token operator\">=</span> text<span class=\"token punctuation\">.</span><span class=\"token function\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>      word <span class=\"token operator\">=</span> word<span class=\"token punctuation\">.</span><span class=\"token function\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>position <span class=\"token operator\">=</span> text<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">,</span> startPosition<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>      index<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>position<span class=\"token punctuation\">,</span> word<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>      startPosition <span class=\"token operator\">=</span> position <span class=\"token operator\">+</span> wordLen<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>    <span class=\"token keyword\">return</span> index<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>  <span class=\"token comment\">// Merge hits into slices</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">mergeIntoSlice</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">start<span class=\"token punctuation\">,</span> end<span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">,</span> searchText</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>    <span class=\"token keyword\">let</span> item <span class=\"token operator\">=</span> index<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>    <span class=\"token keyword\">let</span> <span class=\"token punctuation\">&#123;</span>position<span class=\"token punctuation\">,</span> word<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> item<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>    <span class=\"token keyword\">let</span> hits <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>    <span class=\"token keyword\">let</span> searchTextCountInSlice <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>position <span class=\"token operator\">+</span> word<span class=\"token punctuation\">.</span>length <span class=\"token operator\">&lt;=</span> end <span class=\"token operator\">&amp;&amp;</span> index<span class=\"token punctuation\">.</span>length <span class=\"token operator\">!==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>word <span class=\"token operator\">===</span> searchText<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>        searchTextCountInSlice<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>      hits<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>        position<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>        <span class=\"token literal-property property\">length</span><span class=\"token operator\">:</span> word<span class=\"token punctuation\">.</span>length</pre></td></tr><tr><td data-num=\"100\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>      <span class=\"token keyword\">let</span> wordEnd <span class=\"token operator\">=</span> position <span class=\"token operator\">+</span> word<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>      <span class=\"token comment\">// Move to next position of hit</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>      index<span class=\"token punctuation\">.</span><span class=\"token function\">pop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>      <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">.</span>length <span class=\"token operator\">!==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>        item <span class=\"token operator\">=</span> index<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>        position <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>        word <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>word<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>wordEnd <span class=\"token operator\">></span> position<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>          index<span class=\"token punctuation\">.</span><span class=\"token function\">pop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>          <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>      hits<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>      start<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>      end<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>      <span class=\"token literal-property property\">searchTextCount</span><span class=\"token operator\">:</span> searchTextCountInSlice</pre></td></tr><tr><td data-num=\"122\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>  <span class=\"token comment\">// Highlight title and content</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">highlightKeyword</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">text<span class=\"token punctuation\">,</span> slice</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>    <span class=\"token keyword\">let</span> result <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>    <span class=\"token keyword\">let</span> prevEnd <span class=\"token operator\">=</span> slice<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>    slice<span class=\"token punctuation\">.</span>hits<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">hit</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>      result <span class=\"token operator\">+=</span> text<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span>prevEnd<span class=\"token punctuation\">,</span> hit<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>      <span class=\"token keyword\">let</span> end <span class=\"token operator\">=</span> hit<span class=\"token punctuation\">.</span>position <span class=\"token operator\">+</span> hit<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>      result <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;mark\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>text<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span>hit<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">,</span> end<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">&lt;/mark></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>      prevEnd <span class=\"token operator\">=</span> end<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>    result <span class=\"token operator\">+=</span> text<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span>prevEnd<span class=\"token punctuation\">,</span> slice<span class=\"token punctuation\">.</span>end<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>    <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">inputEventFunction</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isFetched<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>      <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>    <span class=\"token keyword\">let</span> searchText <span class=\"token operator\">=</span> input<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>    <span class=\"token keyword\">let</span> keywords <span class=\"token operator\">=</span> searchText<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">[-\\s]+</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>keywords<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>      keywords<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>searchText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>    <span class=\"token keyword\">let</span> resultItems <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>searchText<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>      <span class=\"token comment\">// Perform local searching</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>      datas<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">&#123;</span>title<span class=\"token punctuation\">,</span> content<span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">&#125;</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre>        <span class=\"token keyword\">let</span> titleInLowerCase <span class=\"token operator\">=</span> title<span class=\"token punctuation\">.</span><span class=\"token function\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre>        <span class=\"token keyword\">let</span> contentInLowerCase <span class=\"token operator\">=</span> content<span class=\"token punctuation\">.</span><span class=\"token function\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>        <span class=\"token keyword\">let</span> indexOfTitle <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>        <span class=\"token keyword\">let</span> indexOfContent <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>        <span class=\"token keyword\">let</span> searchTextCount <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>        keywords<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">keyword</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>          indexOfTitle <span class=\"token operator\">=</span> indexOfTitle<span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span><span class=\"token function\">getIndexByWord</span><span class=\"token punctuation\">(</span>keyword<span class=\"token punctuation\">,</span> titleInLowerCase<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>          indexOfContent <span class=\"token operator\">=</span> indexOfContent<span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span><span class=\"token function\">getIndexByWord</span><span class=\"token punctuation\">(</span>keyword<span class=\"token punctuation\">,</span> contentInLowerCase<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre></pre></td></tr><tr><td data-num=\"163\"></td><td><pre>        <span class=\"token comment\">// Show search results</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>indexOfTitle<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">||</span> indexOfContent<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre>          <span class=\"token keyword\">let</span> hitCount <span class=\"token operator\">=</span> indexOfTitle<span class=\"token punctuation\">.</span>length <span class=\"token operator\">+</span> indexOfContent<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>          <span class=\"token comment\">// Sort index by position of keyword</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>          <span class=\"token punctuation\">[</span>indexOfTitle<span class=\"token punctuation\">,</span> indexOfContent<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">index</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre>            index<span class=\"token punctuation\">.</span><span class=\"token function\">sort</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">itemLeft<span class=\"token punctuation\">,</span> itemRight</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>              <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>itemRight<span class=\"token punctuation\">.</span>position <span class=\"token operator\">!==</span> itemLeft<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre>                <span class=\"token keyword\">return</span> itemRight<span class=\"token punctuation\">.</span>position <span class=\"token operator\">-</span> itemLeft<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"171\"></td><td><pre>              <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre>              <span class=\"token keyword\">return</span> itemLeft<span class=\"token punctuation\">.</span>word<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> item<span class=\"token punctuation\">.</span>word<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre></pre></td></tr><tr><td data-num=\"176\"></td><td><pre>          <span class=\"token keyword\">let</span> slicesOfContent <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre>          <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>indexOfContent<span class=\"token punctuation\">.</span>length <span class=\"token operator\">!==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre>            <span class=\"token keyword\">let</span> item <span class=\"token operator\">=</span> indexOfContent<span class=\"token punctuation\">[</span>indexOfContent<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>            <span class=\"token keyword\">let</span> <span class=\"token punctuation\">&#123;</span>position<span class=\"token punctuation\">,</span> word<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> item<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre>            <span class=\"token comment\">// Cut out 100 characters</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre>            <span class=\"token keyword\">let</span> start <span class=\"token operator\">=</span> position <span class=\"token operator\">-</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre>            <span class=\"token keyword\">let</span> end <span class=\"token operator\">=</span> position <span class=\"token operator\">+</span> <span class=\"token number\">80</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>start <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"184\"></td><td><pre>              start <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"185\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"186\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>end <span class=\"token operator\">&lt;</span> position <span class=\"token operator\">+</span> word<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre>              end <span class=\"token operator\">=</span> position <span class=\"token operator\">+</span> word<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"188\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"189\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>end <span class=\"token operator\">></span> content<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre>              end <span class=\"token operator\">=</span> content<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre>            <span class=\"token keyword\">let</span> tmp <span class=\"token operator\">=</span> <span class=\"token function\">mergeIntoSlice</span><span class=\"token punctuation\">(</span>start<span class=\"token punctuation\">,</span> end<span class=\"token punctuation\">,</span> indexOfContent<span class=\"token punctuation\">,</span> searchText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"193\"></td><td><pre>            searchTextCount <span class=\"token operator\">+=</span> tmp<span class=\"token punctuation\">.</span>searchTextCountInSlice<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre>            slicesOfContent<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>tmp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre></pre></td></tr><tr><td data-num=\"197\"></td><td><pre>          <span class=\"token comment\">// Sort slices in content by search text's count and hits' count</span></pre></td></tr><tr><td data-num=\"198\"></td><td><pre>          slicesOfContent<span class=\"token punctuation\">.</span><span class=\"token function\">sort</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">sliceLeft<span class=\"token punctuation\">,</span> sliceRight</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>sliceLeft<span class=\"token punctuation\">.</span>searchTextCount <span class=\"token operator\">!==</span> sliceRight<span class=\"token punctuation\">.</span>searchTextCount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"200\"></td><td><pre>              <span class=\"token keyword\">return</span> sliceRight<span class=\"token punctuation\">.</span>searchTextCount <span class=\"token operator\">-</span> sliceLeft<span class=\"token punctuation\">.</span>searchTextCount<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"201\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>sliceLeft<span class=\"token punctuation\">.</span>hits<span class=\"token punctuation\">.</span>length <span class=\"token operator\">!==</span> sliceRight<span class=\"token punctuation\">.</span>hits<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"202\"></td><td><pre>              <span class=\"token keyword\">return</span> sliceRight<span class=\"token punctuation\">.</span>hits<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> sliceLeft<span class=\"token punctuation\">.</span>hits<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"203\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"204\"></td><td><pre>            <span class=\"token keyword\">return</span> sliceLeft<span class=\"token punctuation\">.</span>start <span class=\"token operator\">-</span> sliceRight<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"205\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"206\"></td><td><pre></pre></td></tr><tr><td data-num=\"207\"></td><td><pre>          <span class=\"token comment\">// Select top N slices in content</span></pre></td></tr><tr><td data-num=\"208\"></td><td><pre>          <span class=\"token keyword\">let</span> upperBound <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CONFIT</span><span class=\"token punctuation\">.</span>localsearch<span class=\"token punctuation\">.</span>top_n_per_article<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"209\"></td><td><pre>          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>upperBound <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"210\"></td><td><pre>            slicesOfContent <span class=\"token operator\">=</span> slicesOfContent<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> upperBound<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"211\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"212\"></td><td><pre></pre></td></tr><tr><td data-num=\"213\"></td><td><pre>          <span class=\"token keyword\">let</span> resultItem <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"214\"></td><td><pre></pre></td></tr><tr><td data-num=\"215\"></td><td><pre>          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>slicesOfTitle<span class=\"token punctuation\">.</span>length <span class=\"token operator\">!==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"216\"></td><td><pre>            resultItem <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;li>&lt;a href=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>url<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span><span class=\"token function\">highlightKeyword</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">,</span> slicesOfTitle<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">&lt;/a></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"217\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"218\"></td><td><pre>            resultItem <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;li>&lt;a href=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>url<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>title<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">&lt;/a></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"219\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"220\"></td><td><pre></pre></td></tr><tr><td data-num=\"221\"></td><td><pre>          slicesOfContent<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">slice</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"222\"></td><td><pre>            resultItem <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;a href=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>url<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">\">&lt;p></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span><span class=\"token function\">highlightKeyword</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">,</span> slice<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">...&lt;/p>&lt;/a></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"223\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"224\"></td><td><pre></pre></td></tr><tr><td data-num=\"225\"></td><td><pre>          resultItem <span class=\"token operator\">+=</span> <span class=\"token string\">'&lt;/li>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"226\"></td><td><pre>          resultItems<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"227\"></td><td><pre>            <span class=\"token literal-property property\">item</span><span class=\"token operator\">:</span> resultItem<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"228\"></td><td><pre>            <span class=\"token literal-property property\">id</span>  <span class=\"token operator\">:</span> resultItems<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"229\"></td><td><pre>            hitCount<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"230\"></td><td><pre>            searchTextCount</pre></td></tr><tr><td data-num=\"231\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"232\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"233\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"234\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"235\"></td><td><pre></pre></td></tr><tr><td data-num=\"236\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>keywords<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">1</span> <span class=\"token operator\">&amp;&amp;</span> keywords<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"237\"></td><td><pre>      resultContent<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;div id=\"no-result\">&lt;i>&lt;/i>&lt;/div>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"238\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>resultItems<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"239\"></td><td><pre>      resultContent<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;div id=\"no-result\">&lt;i>&lt;/i>&lt;/div>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"240\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"241\"></td><td><pre>      resultItems<span class=\"token punctuation\">.</span><span class=\"token function\">sort</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resultLeft<span class=\"token punctuation\">,</span> resultRight</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"242\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>resultLeft<span class=\"token punctuation\">.</span>searchTextCount <span class=\"token operator\">!==</span> resultRight<span class=\"token punctuation\">.</span>searchTextCount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"243\"></td><td><pre>          <span class=\"token keyword\">return</span> resultRight<span class=\"token punctuation\">.</span>searchTextCount <span class=\"token operator\">-</span> resultLeft<span class=\"token punctuation\">.</span>searchTextCount<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"244\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>resultLeft<span class=\"token punctuation\">.</span>hitCount <span class=\"token operator\">!==</span> resultRight<span class=\"token punctuation\">.</span>hitCount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"245\"></td><td><pre>          <span class=\"token keyword\">return</span> resultRight<span class=\"token punctuation\">.</span>hitCount <span class=\"token operator\">-</span> resultLeft<span class=\"token punctuation\">.</span>hitCount<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"246\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"247\"></td><td><pre>        <span class=\"token keyword\">return</span> resultRight<span class=\"token punctuation\">.</span>id <span class=\"token operator\">-</span> resultLeft<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"248\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"249\"></td><td><pre>      resultContent<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;ul></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>resultItems<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span> <span class=\"token operator\">=></span> result<span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">&lt;/ul></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"250\"></td><td><pre>      window<span class=\"token punctuation\">.</span>pjax <span class=\"token operator\">&amp;&amp;</span> window<span class=\"token punctuation\">.</span>pjax<span class=\"token punctuation\">.</span><span class=\"token function\">refresh</span><span class=\"token punctuation\">(</span>resultContent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"251\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"252\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"253\"></td><td><pre></pre></td></tr><tr><td data-num=\"254\"></td><td><pre>  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchData</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"255\"></td><td><pre>    <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CONFIG</span><span class=\"token punctuation\">.</span>root <span class=\"token operator\">+</span> searchPath<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"256\"></td><td><pre>      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span> <span class=\"token operator\">=></span> response<span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"257\"></td><td><pre>      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"258\"></td><td><pre>        <span class=\"token comment\">// Get the contents from search data</span></pre></td></tr><tr><td data-num=\"259\"></td><td><pre>        isfetched <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"260\"></td><td><pre>        datas <span class=\"token operator\">=</span> isXml <span class=\"token operator\">?</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DOMParser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseFromString</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> <span class=\"token string\">'text/xml'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'entry'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"261\"></td><td><pre>          <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"262\"></td><td><pre>            <span class=\"token literal-property property\">title</span>  <span class=\"token operator\">:</span> element<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'title'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"263\"></td><td><pre>            <span class=\"token literal-property property\">content</span><span class=\"token operator\">:</span> element<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'content'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"264\"></td><td><pre>            <span class=\"token literal-property property\">url</span>    <span class=\"token operator\">:</span> element<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'url'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>textContent</pre></td></tr><tr><td data-num=\"265\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"266\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"267\"></td><td><pre>        <span class=\"token comment\">// Only match articles with not empty titles</span></pre></td></tr><tr><td data-num=\"268\"></td><td><pre>        datas <span class=\"token operator\">=</span> datas<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span> <span class=\"token operator\">=></span> data<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"269\"></td><td><pre>          data<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"270\"></td><td><pre>          data<span class=\"token punctuation\">.</span>content <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>content <span class=\"token operator\">?</span> data<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">&lt;[^>]+></span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"271\"></td><td><pre>          data<span class=\"token punctuation\">.</span>url <span class=\"token operator\">=</span> <span class=\"token function\">decodeURIComponent</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\/&#123;2,&#125;</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"272\"></td><td><pre>          <span class=\"token keyword\">return</span> data<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"273\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"274\"></td><td><pre>        <span class=\"token comment\">// Remove loading animation</span></pre></td></tr><tr><td data-num=\"275\"></td><td><pre>        document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'no-result'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;i>&lt;/i>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"276\"></td><td><pre>        <span class=\"token function\">inputEventFunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"277\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"278\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"279\"></td><td><pre></pre></td></tr><tr><td data-num=\"280\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">CONFIG</span><span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">.</span>preload<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"281\"></td><td><pre>    <span class=\"token function\">fetchData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"282\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"283\"></td><td><pre></pre></td></tr><tr><td data-num=\"284\"></td><td><pre>  <span class=\"token comment\">// Handle and trigger popup window</span></pre></td></tr><tr><td data-num=\"285\"></td><td><pre>  document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.popup-trigger'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"286\"></td><td><pre>    element<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"287\"></td><td><pre>      document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>overflow <span class=\"token operator\">=</span> <span class=\"token string\">'hidden'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"288\"></td><td><pre>      document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.search-pop-overlay'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>classList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'search-active'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"289\"></td><td><pre>      input<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"290\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isfetched<span class=\"token punctuation\">)</span> <span class=\"token function\">fetchData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"291\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"292\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"293\"></td><td><pre></pre></td></tr><tr><td data-num=\"294\"></td><td><pre>  <span class=\"token comment\">// Handle and trigger popup window</span></pre></td></tr><tr><td data-num=\"295\"></td><td><pre>  $<span class=\"token punctuation\">.</span><span class=\"token function\">each</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.search'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"296\"></td><td><pre>    element<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"297\"></td><td><pre>      document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>overflow <span class=\"token operator\">=</span> <span class=\"token string\">'hidden'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"298\"></td><td><pre>      <span class=\"token function\">transition</span><span class=\"token punctuation\">(</span>siteSearch<span class=\"token punctuation\">,</span> <span class=\"token string\">'shrinkIn'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"299\"></td><td><pre>          <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.search-input'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"300\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// transition.shrinkIn</span></pre></td></tr><tr><td data-num=\"301\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"302\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"303\"></td><td><pre></pre></td></tr><tr><td data-num=\"304\"></td><td><pre>  <span class=\"token comment\">// // Monitor main search box</span></pre></td></tr><tr><td data-num=\"305\"></td><td><pre>  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onPopupClose</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"306\"></td><td><pre>    document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>overflow <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"307\"></td><td><pre>    <span class=\"token function\">transition</span><span class=\"token punctuation\">(</span>siteSearch<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"transition.shrinkOut\"</span></pre></td></tr><tr><td data-num=\"308\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"309\"></td><td><pre></pre></td></tr><tr><td data-num=\"310\"></td><td><pre>  siteSearch<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"311\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>target <span class=\"token operator\">===</span> siteSearch<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"312\"></td><td><pre>      <span class=\"token function\">onPopupClose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"313\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"314\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"315\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"316\"></td><td><pre>  <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.close-btn'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> onPopupClose<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"317\"></td><td><pre>  window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pjax:success'</span><span class=\"token punctuation\">,</span> onPopupClose<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"318\"></td><td><pre>  window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'keyup'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"319\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>key <span class=\"token operator\">===</span> <span class=\"token string\">'Escape'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"320\"></td><td><pre>      <span class=\"token function\">onPopupClose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"321\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"322\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"323\"></td><td><pre></pre></td></tr><tr><td data-num=\"324\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"搜索结果样式\"><a class=\"markdownIt-Anchor\" href=\"#搜索结果样式\">#</a> 搜索结果样式</h2>\n<p>搜索结果页面的样式主要由  <code>search.styl</code>  文件决定，我在其中对  <code>#search-item</code>  的内容进行了以下修改：</p>\n<figure class=\"highlight css\"><figcaption data-lang=\"CSS\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token selector\">.item</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 2rem 0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token selector\">a</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token property\">border-bottom</span><span class=\"token punctuation\">:</span> 0.1rem dashed <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--grey-4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> block<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token function\">the-transition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token selector\">span</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 70%<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> block<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token selector\">i</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--grey-4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 0 .3125rem<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"分页功能\"><a class=\"markdownIt-Anchor\" href=\"#分页功能\">#</a> 分页功能</h2>\n<p>对本地搜索的展示结果添加了分页功能，主要代码在  <code>pagination</code>  函数中。另，原主题在翻页时不会自动将滚动条回滚到顶部，这里按照我个人的习惯进行了修改，代码为  <code>resultContent.scrollTop = 0;</code> ，在  <code>pagination</code>  执行完毕后设置该属性。</p>\n",
            "tags": [
                "Hexo"
            ]
        },
        {
            "id": "https://linn-ylz.com/Hexo/blog-content-test/",
            "url": "https://linn-ylz.com/Hexo/blog-content-test/",
            "title": "Shoka 主题测试",
            "date_published": "2021-08-21T13:45:33.000Z",
            "content_html": "<h1 id=\"关于本博客\"><a class=\"markdownIt-Anchor\" href=\"#关于本博客\">#</a> 关于本博客</h1>\n<p>其实很久之前即有搭建博客的想法了，之前也使用过  <code>Hugo</code>  进行尝试，也配置了一些主题，但是往往搭建好之后都没有时间去写博文，因此网站搭建完成之后便不再问津了。这次想着捡起来，是因自己这一年经历了比较多的事情，感觉有很多内容想要记录下来，但是又不太想在其他社交平台上发表，于是最终选择了博客这种形式来记录自己的想法。</p>\n<p>本博客的内容可能各种各样，包括但不限于计算机相关的技术类文章、历史类相关的读书笔记等，基本上就是 “随心所欲”，有什么想记录下来的内容便写上几笔。若能对到访寒舍的看官有所裨益，当是最好不过的了。由于自己略带一点强迫症，可能各篇文章的创建时间和修改时间会相差很大，这点读者如有发现还勿见怪。</p>\n<h1 id=\"关于本文\"><a class=\"markdownIt-Anchor\" href=\"#关于本文\">#</a> 关于本文</h1>\n<p>本文大概是本博客的第一篇正式文章，主要用于记录本博客主题相关的内容，随时有可能发生更改，不过现在基本上博客主题已经搭建成型，中途遇见的问题和  <code>bug</code>  也都基本解决，后续的变动应当不大。顺便也会记录使用的主题之外的其他插件的使用。喜欢这个主题或者某些插件功能的读者可以作为参考。</p>\n<h1 id=\"关于使用的主题\"><a class=\"markdownIt-Anchor\" href=\"#关于使用的主题\">#</a> 关于使用的主题</h1>\n<p>本博客使用的主题是  <code>shoka</code>  ，是我在寻找  <code>Hexo</code>  主题的时候无意间发现的，第一眼就喜欢上了。不过，目前的样式比较偏向少女风格，之后可能会视情况进行自定义修改 <span class=\"spoiler\" title=\"...\">（不过目前这样感觉也还行，反正基本上都是自己看，问题不大）</span>。</p>\n<p>这个主题的作者应该是一个小姐姐，想更详细了解本主题的相关内容，可以访问作者的<a href=\"https://shoka.lostyu.me/\">主页</a>。</p>\n<h1 id=\"功能测试\"><a class=\"markdownIt-Anchor\" href=\"#功能测试\">#</a> 功能测试</h1>\n<p>下文内容主要用于主题提供的功能进行测试，对于遇到的一些  <code>bug</code>  也会提及。</p>\n<h2 id=\"bug\"><a class=\"markdownIt-Anchor\" href=\"#bug\">#</a> Bug</h2>\n<p>本主题提供的功能主要依赖于  <code>hexo-markdown-render-it</code>  插件，而我在使用过程中也碰到了许多问题，花了几天才基本上解决，着实是费了一番功夫。</p>\n<h3 id=\"_configshokayml-配置文件无法生效\"><a class=\"markdownIt-Anchor\" href=\"#_configshokayml-配置文件无法生效\">#</a>  <code>_config.shoka.yml</code>  配置文件无法生效</h3>\n<p>第一个大的问题是  <code>_config.shoka.yml</code>  配置文件中和插件相关的  <code>markdown</code>  选项设置无法生效。主要原因是在  <code>Hexo</code>  进行渲染时，读取到的配置变量  <code>hexo.config</code>  中没有  <code>markdown</code>  相关的内容，该部分配置的内容在另一个变量  <code>hexo.config.theme_config.markdown</code>  中，因而在生成静态文件的过程中无法读取到正确的配置，从而一直使用默认的配置，使得无法对插件的功能进行自定义 <span class=\"spoiler\" title=\"...\">（这怎么能忍！）</span>。</p>\n<p>我一开始的解决方法是找到相关的代码，将  <code>hexo.config.theme_config.markdown</code>  的内容也添加到  <code>hexo.config</code>  中去。但是在调试过程中，发现了一个非常 “骇人” 的  <code>bug</code> ，尽管  <code>hexo.config</code>  的内容已经添加了和  <code>markdown</code>  相关的配置内容，插件的脚本中读取到的配置也是自定义的，但是生成的网页内容依然使用的默认配置 <span class=\"spoiler\" title=\"...\">（差点要吐血）</span>。</p>\n<p>在网上搜索解决方法的过程中，发现直接修改  <code>npm</code>  安装的插件内容可能无法生效，因此只得暂时作罢。</p>\n<h3 id=\"自定义插件相关脚本\"><a class=\"markdownIt-Anchor\" href=\"#自定义插件相关脚本\">#</a> 自定义插件相关脚本</h3>\n<p>上述  <code>bug</code>  困扰了我很久，最后找到了另一种解决方式。我将插件相关的代码移动到了主题文件夹中  <code>scripts</code>  文件夹下的  <code>renderer</code>  文件夹，其余依赖的  <code>markdown-it</code>  相关插件则依旧通过正常方式安装，通过自己编写  <code>js</code>  代码的方式注册相关的渲染器，调用相关插件的功能。目前基本上解决了上述  <code>bug</code> 。</p>\n<p>其他和功能相关的  <code>bug</code>  则放在各个功能说明中，这里不再赘述。</p>\n<h2 id=\"图片\"><a class=\"markdownIt-Anchor\" href=\"#图片\">#</a> 图片</h2>\n<h3 id=\"插入本地图片\"><a class=\"markdownIt-Anchor\" href=\"#插入本地图片\">#</a> 插入本地图片</h3>\n<p>插入图片的方式的格式为：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>![alt_name](path/to/img img_name)</pre></td></tr></table></figure><p>其中的  <code>alt_name</code>  是图片无法显示的时候展示的文字内容， <code>path/to/img</code>  是图片资源的路径，也可以是网络地址， <code>img_name</code>  则是显示在图片下方的图片名称。图片资源的路径主要有两种方式，下文会详细说明。</p>\n<p>通过相对路径访问</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token url\"><span class=\"token operator\">!</span>[<span class=\"token content\">本人常用头像</span>](<span class=\"token url\">/images/my_small_avatar.jpg</span> <span class=\"token string\">\"本人常用头像\"</span>)</span></pre></td></tr></table></figure><p>需要特别注意路径问题：必须是  <code>/images/xx.jpg</code>  而不是  <code>images/xx.jpg</code> ，否则图片会加载异常</p>\n<p>本人常用的头像：</p>\n<p><img loading=\"lazy\" data-src=\"/images/my_small_avatar.jpg\" alt=\"本人常用头像\" title=\"本人常用头像\"></p>\n<p>还有一种方式是利用  <code>CDN</code>  加速对本地资源的访问。将图片的地址更换成  <code>CDN</code>  开头的网址，达到加速资源访问的效果。因为  <code>CDN</code>  会对  <code>github</code>  的资源进行处理，因此这里可以直接将地址换成自己的仓库对应的  <code>CDN</code> ，地址的格式为  <code>https://cdn.jsdelivr.net/gh/[github_username]/[repository_name]@[tag]/path/to/resource</code> ，其中  <code>github_username</code>  和  <code>repository_name</code>  可以参照自己的  <code>github</code>  地址中的内容， <code>[tag]</code>  为资源所在的分支，一般直接用  <code>latest</code>  即可，最后即所需资源的具体路径。</p>\n<p>示例：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token url\"><span class=\"token operator\">!</span>[<span class=\"token content\">本人常用头像</span>](<span class=\"token url\">https://cdn.jsdelivr.net/gh/YangLinzhuo/yanglinzhuo.github.io@latest/images/my_small_avatar.jpg</span> <span class=\"token string\">\"本人常用头像\"</span>)</span></pre></td></tr></table></figure><p><img loading=\"lazy\" data-src=\"https://cdn.jsdelivr.net/gh/YangLinzhuo/yanglinzhuo.github.io@latest/images/my_small_avatar.jpg\" alt=\"本人常用头像\" title=\"本人常用头像\"></p>\n<h3 id=\"插入网络图片\"><a class=\"markdownIt-Anchor\" href=\"#插入网络图片\">#</a> 插入网络图片</h3>\n<p>直接将资源路径替换成网络地址即可。</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token url\"><span class=\"token operator\">!</span>[<span class=\"token content\">主题默认头像</span>](<span class=\"token url\">https://cdn.jsdelivr.net/gh/amehime/shoka@latest/images/avatar.jpg</span> <span class=\"token string\">\"主题默认头像\"</span>)</span></pre></td></tr></table></figure><p>本主题的默认头像：</p>\n<p><img loading=\"lazy\" data-src=\"https://cdn.jsdelivr.net/gh/amehime/shoka@latest/images/avatar.jpg\" alt=\"主题默认头像\" title=\"主题默认头像\"></p>\n<h2 id=\"表格\"><a class=\"markdownIt-Anchor\" href=\"#表格\">#</a> 表格</h2>\n<p>本主题使用了表格插件 <a href=\"https://www.npmjs.com/package/markdown-it-multimd-table\"> <code>markdown-it-multimd-table</code> </a>，在原来表格的基础上，扩展了表格的展示形式。详细内容可以点击前方插件名称查看。下文主要介绍几种我可能使用到的功能。</p>\n<h3 id=\"基本功能\"><a class=\"markdownIt-Anchor\" href=\"#基本功能\">#</a> 基本功能</h3>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>|             |          Grouping           ||</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token table\"><span class=\"token table-header-row\"><span class=\"token table-header important\">First Header  </span><span class=\"token punctuation\">|</span><span class=\"token table-header important\"> Second Header </span><span class=\"token punctuation\">|</span><span class=\"token table-header important\"> Third Header </span><span class=\"token punctuation\">|</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></span><span class=\"token table-line\"> <span class=\"token punctuation\">------------</span> <span class=\"token punctuation\">|</span> <span class=\"token punctuation\">:-----------:</span> <span class=\"token punctuation\">|</span> <span class=\"token punctuation\">-----------:</span> <span class=\"token punctuation\">|</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></span><span class=\"token table-data-rows\"></span></span>Content       |          <span class=\"token italic\"><span class=\"token punctuation\">*</span><span class=\"token content\">Long Cell</span><span class=\"token punctuation\">*</span></span>        ||</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Content       |   <span class=\"token bold\"><span class=\"token punctuation\">**</span><span class=\"token content\">Cell</span><span class=\"token punctuation\">**</span></span>    |         Cell |</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                                         </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>New section   |     More      |         Data |</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>And more      | With an escaped '\\\\|'       ||</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>[Prototype table]</pre></td></tr></table></figure><table>\n<caption id=\"prototypetable\" style=\"caption-side: bottom\">Prototype table</caption>\n<thead>\n<tr>\n<th></th>\n<th style=\"text-align:center\" colspan=\"2\">Grouping</th>\n</tr>\n<tr>\n<th>First Header</th>\n<th style=\"text-align:center\">Second Header</th>\n<th style=\"text-align:right\">Third Header</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Content</td>\n</tr>\n<tr>\n<td>Content</td>\n<td style=\"text-align:center\"><strong>Cell</strong></td>\n<td style=\"text-align:right\">Cell</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>New section</td>\n<td style=\"text-align:center\">More</td>\n<td style=\"text-align:right\">Data</td>\n</tr>\n<tr>\n<td>And more</td>\n<td style=\"text-align:center\" colspan=\"2\">With an escaped ‘\\|’</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"multiline-optional\"><a class=\"markdownIt-Anchor\" href=\"#multiline-optional\">#</a> Multiline (optional)</h3>\n<p>多行内容可以在表格中的一个  <code>cell</code>  中显示，对同一个  <code>cell</code>  中的多行内容，除最后一行外，其余每一行的结尾需要添加  <code>\\</code>  ，使得多行的内容能够合并到一个  <code>cell</code>  中。</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token table\"><span class=\"token table-header-row\"><span class=\"token punctuation\">|</span><span class=\"token table-header important\">   Markdown   </span><span class=\"token punctuation\">|</span><span class=\"token table-header important\"> Rendered HTML </span><span class=\"token punctuation\">|</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></span><span class=\"token table-line\"><span class=\"token punctuation\">|</span><span class=\"token punctuation\">--------------</span><span class=\"token punctuation\">|</span><span class=\"token punctuation\">---------------</span><span class=\"token punctuation\">|</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></span><span class=\"token table-data-rows\"></span></span>|    <span class=\"token italic\"><span class=\"token punctuation\">*</span><span class=\"token content\">Italic</span><span class=\"token punctuation\">*</span></span>  | <span class=\"token italic\"><span class=\"token punctuation\">*</span><span class=\"token content\">Italic</span><span class=\"token punctuation\">*</span></span>      | \\</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>|              |               |</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>|    - Item 1  | - Item 1      | \\</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>|    - Item 2  | - Item 2      |</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>|    ```python | ```python       \\</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>|    .1 + .2   | .1 + .2         \\</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>|    ```       | ```           |</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>[Multiline table]</pre></td></tr></table></figure><table>\n<caption id=\"multilinetable\" style=\"caption-side: bottom\">Multiline table</caption>\n<thead>\n<tr>\n<th>Markdown</th>\n<th>Rendered HTML</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><em>Italic</em></td>\n<td><em>Italic</em></td>\n<td>\\</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>- Item 1</td>\n<td>- Item 1</td>\n<td>\\</td>\n</tr>\n<tr>\n<td>- Item 2</td>\n<td>- Item 2</td>\n</tr>\n<tr>\n<td>```python</td>\n<td>```python       \\</td>\n</tr>\n<tr>\n<td>.1 + .2</td>\n<td>.1 + .2         \\</td>\n</tr>\n<tr>\n<td>```</td>\n<td>```</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"rowspan-optional\"><a class=\"markdownIt-Anchor\" href=\"#rowspan-optional\">#</a> Rowspan (optional)</h3>\n<p>使得一个  <code>cell</code>  占据多行，使用  <code>^^</code>  表示当前  <code>cell</code>  和上一行的  <code>cell</code>  合并。</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token table\"><span class=\"token table-header-row\"><span class=\"token table-header important\">Stage </span><span class=\"token punctuation\">|</span><span class=\"token table-header important\"> Direct Products </span><span class=\"token punctuation\">|</span><span class=\"token table-header important\"> ATP Yields</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></span><span class=\"token table-line\"><span class=\"token punctuation\">----:</span> <span class=\"token punctuation\">|</span> <span class=\"token punctuation\">--------------:</span> <span class=\"token punctuation\">|</span> <span class=\"token punctuation\">---------:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></span><span class=\"token table-data-rows\"></span></span>Glycolysis | 2 ATP ||</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>^^ | 2 NADH | 3--5 ATP |</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Pyruvaye oxidation | 2 NADH | 5 ATP |</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>Citric acid cycle | 2 ATP ||</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>^^ | 6 NADH | 15 ATP |</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>^^ | 2 FADH2 | 3 ATP |</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token bold\"><span class=\"token punctuation\">**</span><span class=\"token content\">30--32</span><span class=\"token punctuation\">**</span></span> ATP |||</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>[Rowspan table]</pre></td></tr></table></figure><table>\n<caption id=\"rowspantable\" style=\"caption-side: bottom\">Rowspan table</caption>\n<thead>\n<tr>\n<th style=\"text-align:right\">Stage</th>\n<th style=\"text-align:right\">Direct Products</th>\n<th style=\"text-align:right\">ATP Yields</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:right\">Glycolysis</td>\n</tr>\n<tr>\n<td style=\"text-align:right\">^^</td>\n<td style=\"text-align:right\">2 NADH</td>\n<td style=\"text-align:right\">3–5 ATP</td>\n</tr>\n<tr>\n<td style=\"text-align:right\">Pyruvaye oxidation</td>\n<td style=\"text-align:right\">2 NADH</td>\n<td style=\"text-align:right\">5 ATP</td>\n</tr>\n<tr>\n<td style=\"text-align:right\">Citric acid cycle</td>\n</tr>\n<tr>\n<td style=\"text-align:right\">^^</td>\n<td style=\"text-align:right\">6 NADH</td>\n<td style=\"text-align:right\">15 ATP</td>\n</tr>\n<tr>\n<td style=\"text-align:right\">^^</td>\n<td style=\"text-align:right\">2 FADH2</td>\n<td style=\"text-align:right\">3 ATP</td>\n</tr>\n<tr></tr>\n</tbody>\n</table>\n<h3 id=\"headerless-optional\"><a class=\"markdownIt-Anchor\" href=\"#headerless-optional\">#</a> Headerless (optional)</h3>\n<p>省略表头  <code>cell</code>  。</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>|--|--|--|--|--|--|--|--|</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>|♜|  |♝|♛|♚|♝|♞|♜|</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>|  |♟|♟|♟|  |♟|♟|♟|</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>|♟|  |♞|  |  |  |  |  |</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>|  |♗|  |  |♟|  |  |  |</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>|  |  |  |  |♙|  |  |  |</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>|  |  |  |  |  |♘|  |  |</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>|♙|♙|♙|♙|  |♙|♙|♙|</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>|♖|♘|♗|♕|♔|  |  |♖|</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>[Headerless table]</pre></td></tr></table></figure><p>|–|–|–|–|–|–|–|–|<br>\n|♜|  |♝|♛|♚|♝|♞|♜|<br>\n|  |♟|♟|♟|  |♟|♟|♟|<br>\n|♟|  |♞|  |  |  |  |  |<br>\n|  |♗|  |  |♟|  |  |  |<br>\n|  |  |  |  |♙|  |  |  |<br>\n|  |  |  |  |  |♘|  |  |<br>\n|♙|♙|♙|♙|  |♙|♙|♙|<br>\n|♖|♘|♗|♕|♔|  |  |♖|<br>\n[Headerless table]</p>\n<h2 id=\"列表\"><a class=\"markdownIt-Anchor\" href=\"#列表\">#</a> 列表</h2>\n<h3 id=\"ordered-list\"><a class=\"markdownIt-Anchor\" href=\"#ordered-list\">#</a> Ordered list</h3>\n<ol>\n<li>first</li>\n<li>second</li>\n<li>third</li>\n</ol>\n<h3 id=\"unordered-list\"><a class=\"markdownIt-Anchor\" href=\"#unordered-list\">#</a> Unordered list</h3>\n<ul>\n<li>first</li>\n<li>second</li>\n<li>third</li>\n</ul>\n<h3 id=\"definition-list\"><a class=\"markdownIt-Anchor\" href=\"#definition-list\">#</a> Definition list</h3>\n<p>使用 <a href=\"https://www.npmjs.com/package/markdown-it-deflist\"> <code>markdown-it-deflist</code> </a> 插件，基于 <a href=\"https://pandoc.org/MANUAL.html#definition-lists\"> <code>pandoc</code> </a> 的语法格式，而  <code>pandoc</code>  使用的则是 <a href=\"https://michelf.ca/projects/php-markdown/extra/\"> <code>PHP Markdown Extra</code> </a> 的语法。</p>\n<p>示例如下：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">\nTerm 1\n\n:   Definition 1\n\nTerm 2 with *inline markup*\n\n:   Definition 2\n\n        { some code, part of Definition 2 }\n\n    Third paragraph of definition 2.\n</span></pre></td></tr></table></figure><dl>\n<dt>Term 1</dt>\n<dd>\n<p>Definition 1</p>\n</dd>\n<dt>Term 2 with <em>inline markup</em></dt>\n<dd>\n<p>Definition 2</p>\n<pre><code>  &#123; some code, part of Definition 2 &#125;\n</code></pre>\n<p>Third paragraph of definition 2.</p>\n</dd>\n</dl>\n<p>每个  <code>Term</code>  必须单独成行，和  <code>definition</code>  之间可以添加空行。每个  <code>Term</code>  之下至少包含一个  <code>definition</code> ，每个  <code>definition</code>  之前以分号  <code>:</code>  或者波浪号  <code>~</code>  开头，可以添加一个或者两个空格的缩进。</p>\n<p>一个  <code>Term</code>  可能包含多个  <code>definition</code> ，每个  <code>definition</code>  可能由一个或多个  <code>block</code>  元素构成（如  <code>paragraph</code> ， <code>code block</code> ， <code>list</code>  等等），这些  <code>block</code>  元素需要添加四个空格或者一个  <code>tab</code>  的缩进。正常情况下，这些元素都需要添加缩进。不过，我们也可以偷懒省略  <code>paragraph</code>  或者其他  <code>block</code>  元素的第一行之外其他行的缩进：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">\nTerm 1\n\n:   Definition\nwith lazy continuation.\n\n    Second paragraph of the definition.\n</span></pre></td></tr></table></figure><dl>\n<dt>Term 1</dt>\n<dd>\n<p>Definition<br>\nwith lazy continuation.</p>\n<p>Second paragraph of the definition.</p>\n</dd>\n</dl>\n<p>如果在  <code>definition</code>  之前添加了空格，那么  <code>definition</code>  的文本会被当成一个新的  <code>paragraph</code> 。在某些格式下， <code>Term</code>  和  <code>definition</code>  之间的间隙可能会更大。如果需要更紧凑的显示，那么需要省略掉  <code>definition</code>  之前的空格：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">\nTerm 1\n  ~ Definition 1\n\nTerm 2\n  ~ Definition 2a\n  ~ Definition 2b\n</span></pre></td></tr></table></figure><dl>\n<dt>Term 1</dt>\n<dd>Definition 1</dd>\n<dt>Term 2</dt>\n<dd>Definition 2a</dd>\n<dd>Definition 2b</dd>\n</dl>\n<h2 id=\"链接块\"><a class=\"markdownIt-Anchor\" href=\"#链接块\">#</a> 链接块</h2>\n<p>链接块功能基于  <code>Hexo</code>  提供的  <code>tag</code>  以  <code>&#123;% links %&#125;` 开头，以 `&#123;% endlinks %&#125;</code>  结尾，内部格式为：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token list punctuation\">-</span> site: 网站名称</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  owner: 网站作者</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  url: 网站地址</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  desc: 网站描述，若为空，则会显示网站地址</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  image: 显示图像</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  color: 名称显示的颜色</pre></td></tr></table></figure><p>例如：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token list punctuation\">-</span> site: 優萌初華</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  owner: 霜月琉璃</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  url: https://shoka.lostyu.me</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  desc: 琉璃的医学 &amp; 编程笔记</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  image: https://cdn.jsdelivr.net/gh/amehime/shoka@latest/images/avatar.jpg</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  color: \"#e9546b\"</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token list punctuation\">-</span> site: 優萌初華</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  owner: 霜月琉璃</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  url: https://shoka.lostyu.me</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  image: images/avatar.jpg</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token list punctuation\">-</span> site: 優萌初華</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  url: https://shoka.lostyu.me</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  desc: 琉璃的医学 &amp; 编程笔记</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  color: \"#9d5b8b\"</pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token list punctuation\">-</span> site: Linn's Blog</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  owner: Linn</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  desc: 我的博客</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  url: https://yanglinzhuo.github.io/</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  image: https://yanglinzhuo.github.io/images/my_small_avatar.jpg</pre></td></tr></table></figure><div class=\"links\"><div class=\"item\" title=\"霜月琉璃\" style=\"--block-color:#e9546b;\"><a href=\"https://shoka.lostyu.me\" class=\"image\" data-background-image=\"https://cdn.jsdelivr.net/gh/amehime/shoka@latest/images/avatar.jpg\"></a>\n        <div class=\"info\">\n        <a href=\"https://shoka.lostyu.me\" class=\"title\">優萌初華</a>\n        <p class=\"desc\">琉璃的医学 & 编程笔记</p>\n        </div></div><div class=\"item\" title=\"霜月琉璃\"><a href=\"https://shoka.lostyu.me\" class=\"image\" data-background-image=\"/images/avatar.jpg\"></a>\n        <div class=\"info\">\n        <a href=\"https://shoka.lostyu.me\" class=\"title\">優萌初華</a>\n        <p class=\"desc\">https://shoka.lostyu.me</p>\n        </div></div><div class=\"item\" title=\"優萌初華\" style=\"--block-color:#9d5b8b;\"><a href=\"https://shoka.lostyu.me\" class=\"image\" data-background-image=\"/assets/404.png\"></a>\n        <div class=\"info\">\n        <a href=\"https://shoka.lostyu.me\" class=\"title\">優萌初華</a>\n        <p class=\"desc\">琉璃的医学 & 编程笔记</p>\n        </div></div><div class=\"item\" title=\"Linn\"><a href=\"https://yanglinzhuo.github.io/\" class=\"image\" data-background-image=\"https://yanglinzhuo.github.io/images/my_small_avatar.jpg\"></a>\n        <div class=\"info\">\n        <a href=\"https://yanglinzhuo.github.io/\" class=\"title\">Linn's Blog</a>\n        <p class=\"desc\">我的博客</p>\n        </div></div></div>\n<h2 id=\"代码块\"><a class=\"markdownIt-Anchor\" href=\"#代码块\">#</a> 代码块</h2>\n<p>代码块使用插件  <code>markdown-it-prism</code>  进行高亮，这个插件放在了  <code>themes/shoka/scripts/renderer/</code>  下，需要注意的是，要把  <code>_config.yml</code>  中的  <code>highlight</code>  和  <code>prismjs</code>  的  <code>enable</code>  选项都设置为  <code>false</code> ，否则  <code>Hexo</code>  会进行预处理，导致后续  <code>markdown-it</code>  渲染时，代码块的内容乱码，使得插件无法正常识别代码块，渲染失败。</p>\n<p>代码块头部格式如下：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token url\">[<span class=\"token content\">language</span>] [<span class=\"token variable\">title</span>]</span> <span class=\"token url\">[<span class=\"token content\">url</span>] [<span class=\"token variable\">link text</span>]</span> <span class=\"token url\">[<span class=\"token content\">mark</span>] [<span class=\"token variable\">command</span>]</span></pre></td></tr></table></figure><table>\n<caption id=\"codeblocksyntax\" style=\"caption-side: bottom\">Code Block Syntax</caption>\n<thead>\n<tr>\n<th>选项</th>\n<th>描述</th>\n<th>默认值</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>language</td>\n<td>- 支持的语言<a href=\"https://prismjs.com/#supported-languages\">戳此</a></td>\n<td><code>null</code>  \\</td>\n</tr>\n<tr>\n<td></td>\n<td>- 如果不需要代码高亮，但希望显示代码块样式，则设为 <code>raw</code></td>\n<td>\\</td>\n</tr>\n<tr>\n<td></td>\n<td>- 留空或设为 <code>info</code> ，将不显示代码高亮和代码块样式</td>\n<td></td>\n</tr>\n<tr>\n<td>title</td>\n<td>代码块的标题文字</td>\n<td><code>null</code></td>\n</tr>\n<tr>\n<td>url</td>\n<td>代码块标题右侧显示的链接</td>\n<td><code>null</code></td>\n</tr>\n<tr>\n<td>link text</td>\n<td>上述链接显示的标题</td>\n<td><code>link</code></td>\n</tr>\n<tr>\n<td>mark</td>\n<td>行高亮显示，格式为 <code>mark:[row],[row ]-[row_start]-[row_end],[other_row]</code> 。</td>\n<td><code>null</code>  \\</td>\n</tr>\n<tr>\n<td></td>\n<td>例如 <code>mark:1,4-7,10</code> ，将高亮显示第 1、4、5、6、7、10 行</td>\n<td></td>\n</tr>\n<tr>\n<td>command</td>\n<td>命令行提示符，格式为 <code>command:([&quot;Prompt&quot;]:[row],[row]||[&quot;Prompt&quot;]:[row_start]-[row_end])</code></td>\n<td><code>null</code>  \\</td>\n</tr>\n<tr>\n<td></td>\n<td>例如 <code>command:(&quot;[root@localhost] $&quot;:1,9-10||&quot;[admin@remotehost] #&quot;:4-6)</code></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p>需要按照原始方式显示内容，可以使用：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">\n  {% raw %}\n    content\n  {% endraw %}</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token comment\"></span></pre></td></tr></table></figure><figure class=\"highlight java\"><figcaption data-lang=\"java\"><span>行高亮</span><a href=\"https://shoka.lostyu.me\">参考链接</a></figcaption><table><tr class=\"marked\"><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Scanner</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">Scanner</span> in <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Scanner</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>in<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">// 输入 Scan 之后，按下键盘 Alt + “/” 键，Eclipse 下自动补全。</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span>println <span class=\"token punctuation\">(</span>in<span class=\"token punctuation\">.</span>nextLine <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr class=\"marked\"><td data-num=\"6\"></td><td><pre><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span>println <span class=\"token punctuation\">(</span><span class=\"token string\">\"Hello\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"world.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>命令行提示符</span></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token builtin class-name\">pwd</span></pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"\"></td><td><pre>/usr/home/chris/bin</pre></td></tr><tr><td data-num=\"3\"></td><td data-command=\"\"></td><td><pre><span class=\"token function\">ls</span> <span class=\"token parameter variable\">-la</span></pre></td></tr><tr><td data-num=\"4\"></td><td data-command=\"[admin@remotehost] #\"></td><td><pre>total <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"5\"></td><td data-command=\"[admin@remotehost] #\"></td><td><pre>drwxr-xr-x   <span class=\"token number\">2</span> chris  chris     <span class=\"token number\">11</span> Jan <span class=\"token number\">10</span> <span class=\"token number\">16</span>:48 <span class=\"token builtin class-name\">.</span></pre></td></tr><tr><td data-num=\"6\"></td><td data-command=\"[admin@remotehost] #\"></td><td><pre>drwxr--r-x  <span class=\"token number\">45</span> chris  chris     <span class=\"token number\">92</span> Feb <span class=\"token number\">14</span> <span class=\"token number\">11</span>:10 <span class=\"token punctuation\">..</span></pre></td></tr><tr><td data-num=\"7\"></td><td data-command=\"\"></td><td><pre>-rwxr-xr-x   <span class=\"token number\">1</span> chris  chris    <span class=\"token number\">444</span> Aug <span class=\"token number\">25</span>  <span class=\"token number\">2013</span> backup</pre></td></tr><tr><td data-num=\"8\"></td><td data-command=\"\"></td><td><pre>-rwxr-xr-x   <span class=\"token number\">1</span> chris  chris    <span class=\"token number\">642</span> Jan <span class=\"token number\">17</span> <span class=\"token number\">14</span>:42 deploy</pre></td></tr><tr><td data-num=\"9\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token parameter variable\">-A</span></pre></td></tr><tr><td data-num=\"10\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">git</span> commit <span class=\"token parameter variable\">-m</span> <span class=\"token string\">\"update\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td data-command=\"\"></td><td><pre><span class=\"token function\">git</span> push</pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span></pre></td></tr></table></figure><h2 id=\"练习题与答案\"><a class=\"markdownIt-Anchor\" href=\"#练习题与答案\">#</a> 练习题与答案</h2>\n<p>这个功能用于显示练习题。需要在  <code>Front Matter</code>  中添加  <code>quiz: true</code> ，以正确显示题型标签。</p>\n<p>本功能基于  <code>markdown-it-bracketed-spans</code>  和  <code>markdown-it-attrs</code>  插件，以下是一些标签及其对应含义：</p>\n<table>\n<thead>\n<tr>\n<th>标签</th>\n<th>含义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>&#123;.quiz&#125;</code></td>\n<td>选择题</td>\n</tr>\n<tr>\n<td><code>&#123;.quiz .multi&#125;</code></td>\n<td>多选题</td>\n</tr>\n<tr>\n<td><code>&#123;.quiz .true&#125;</code></td>\n<td>正确的判断题</td>\n</tr>\n<tr>\n<td><code>&#123;.quiz .false&#125;</code></td>\n<td>错误的判断题</td>\n</tr>\n<tr>\n<td><code>&#123;.quiz .fill&#125;</code></td>\n<td>填空题</td>\n</tr>\n<tr>\n<td><code>[]&#123;.gap&#125;</code></td>\n<td>空白下划线</td>\n</tr>\n<tr>\n<td><code>[答案内容]&#123;.gap&#125;</code></td>\n<td>答案内容带下划线</td>\n</tr>\n<tr>\n<td><code>&#123;.options&#125;</code></td>\n<td>ABCDE 选项</td>\n</tr>\n<tr>\n<td><code>&#123;.correct&#125;</code></td>\n<td>选择题的正确选项</td>\n</tr>\n<tr>\n<td><code>&gt;</code></td>\n<td>答案解析</td>\n</tr>\n<tr>\n<td><code>[8.4]&#123;.mistake&#125;</code></td>\n<td>错题备注</td>\n</tr>\n</tbody>\n</table>\n<p><span class=\"spoiler\" title=\"...\">该功能或许可以用于复习面试题。</span></p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"><span>示例</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>---</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>title: 练习题与答案</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>quiz: true</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>---</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>1. 编译时多态主要指运算符重载与函数重载，而运行时多态主要指虚函数。 &#123;.quiz .true&#125;</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>2. 有基类 &#96;SHAPE&#96;，派生类 &#96;CIRCLE&#96;，声明如下变量：  &#123;.quiz .multi&#125;</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    &#96;&#96;&#96;cpp</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    SHAPE shape1,*p1;</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    CIRCLE circle1,*q1;</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    &#96;&#96;&#96;</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    下列哪些项是 “派生类对象替换基类对象”。</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    - &#96;p1&#x3D;&circle1;&#96; &#123;.correct&#125;</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    - &#96;q1&#x3D;&shape1;&#96;</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    - &#96;shape1&#x3D;circle1;&#96; &#123;.correct&#125;</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    - &#96;circle1&#x3D;shape1;&#96;</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>&#123;.options&#125;</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    &gt; - :heavy_check_mark: 令基类对象的指针指向派生类对象</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    &gt; - :x: 派生类指针指向基类的引用</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    &gt; - :heavy_check_mark: 派生类对象给基类对象赋值</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    &gt; - :x: 基类对象给派生类对象赋值</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    &gt; &#123;.options&#125;</pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>3. 下列叙述正确的是 []&#123;.gap&#125; 。 &#123;.quiz&#125;</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    - 虚函数只能定义成无参函数</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    - 虚函数不能有返回值</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    - 能定义虚构造函数</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    - A、B、C 都不对 &#123;.correct&#125;</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>&#123;.options&#125;</pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>10. 如果定义 &#96;int e&#x3D;8; double f&#x3D;6.4, g&#x3D;8.9;&#96;，则表达式 &#96;f+int (e&#x2F;3*int (f+g)&#x2F;2)%4&#96; 的值为 [9.4]&#123;.gap&#125;。 &#123;.quiz .fill&#125;</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    &gt; 注意运算顺序和数据类型</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    &gt; [8.4]&#123;.mistake&#125;</pre></td></tr></table></figure><ol>\n<li class=\"quiz true\">\n<p>编译时多态主要指运算符重载与函数重载，而运行时多态主要指虚函数。</p>\n</li>\n<li class=\"quiz multi\">\n<p>有基类  <code>SHAPE</code> ，派生类  <code>CIRCLE</code> ，声明如下变量： </p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>SHAPE shape1<span class=\"token punctuation\">,</span><span class=\"token operator\">*</span>p1<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>CIRCLE circle1<span class=\"token punctuation\">,</span><span class=\"token operator\">*</span>q1<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>下列哪些项是 “派生类对象替换基类对象”。</p>\n<ul class=\"options\">\n<li class=\"correct\"><code>p1=&amp;circle1;</code> </li>\n<li><code>q1=&amp;shape1;</code></li>\n<li class=\"correct\"><code>shape1=circle1;</code> </li>\n<li><code>circle1=shape1;</code></li>\n</ul>\n<blockquote>\n<ul class=\"options\">\n<li>✔️ 令基类对象的指针指向派生类对象</li>\n<li>❌ 派生类指针指向基类的引用</li>\n<li>✔️ 派生类对象给基类对象赋值</li>\n<li>❌ 基类对象给派生类对象赋值</li>\n</ul>\n</blockquote>\n</li>\n<li class=\"quiz\">\n<p>下列叙述正确的是 <span class=\"gap\"></span> 。</p>\n<ul class=\"options\">\n<li>虚函数只能定义成无参函数</li>\n<li>虚函数不能有返回值</li>\n<li>能定义虚构造函数</li>\n<li class=\"correct\">A、B、C 都不对</li>\n</ul>\n</li>\n<li class=\"quiz fill\">\n<p>如果定义  <code>int e=8; double f=6.4, g=8.9;</code> ，则表达式  <code>f+int (e/3*int (f+g)/2)%4</code>  的值为 <span class=\"gap\">9.4</span>。</p>\n<blockquote>\n<p>注意运算顺序和数据类型<br>\n<span class=\"mistake\"> 8.4</span></p>\n</blockquote>\n</li>\n</ol>\n<h2 id=\"emoji\"><a class=\"markdownIt-Anchor\" href=\"#emoji\">#</a> emoji</h2>\n<p>本功能基于  <code>markdown-it-emoji</code> ，想要查看其他表情的对应代码可以<a href=\"https://github.com/markdown-it/markdown-it-emoji/blob/master/lib/data/full.json\">点击此处</a>。</p>\n<p><span class=\"spoiler\" title=\"...\">看了下，大概最常用的还是 “流汗黄豆” 吧。</span></p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>:sweat_smile:  # 流汗黄豆</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>:kissing_heart: </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>:ring:</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>:notes:</pre></td></tr></table></figure><p>😅<br>\n😘<br>\n💍<br>\n🎶</p>\n<h2 id=\"文字特效\"><a class=\"markdownIt-Anchor\" href=\"#文字特效\">#</a> 文字特效</h2>\n<p>本功能基于  <code>markdown-it-ins</code> 、  <code>markdown-it-bracketed-spans</code>  和  <code>markdown-it-attrs</code></p>\n<blockquote>\n<p>本主题风格颜色通用样式： <code>default</code> 、 <code>primary</code> 、 <code>success</code> 、 <code>info</code> 、 <code>warning</code> 、 <code>danger</code></p>\n</blockquote>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>++下划线++</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>++波浪线++&#123;.wavy&#125;</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>++着重点++&#123;.dot&#125;</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>++紫色下划线++&#123;.primary&#125;</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>++绿色波浪线++&#123;.wavy .success&#125;</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>++黄色着重点++&#123;.dot .warning&#125;</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token strike\"><span class=\"token punctuation\">~~</span><span class=\"token content\">删除线</span><span class=\"token punctuation\">~~</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token strike\"><span class=\"token punctuation\">~~</span><span class=\"token content\">红色删除线</span><span class=\"token punctuation\">~~</span></span>&#123;.danger&#125;</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>==荧光高亮==</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>[赤橙黄绿青蓝紫]&#123;.rainbow&#125;</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>[红色]&#123;.red&#125;</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>[粉色]&#123;.pink&#125;</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>[橙色]&#123;.orange&#125;</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>[红色]&#123;.yellow&#125;</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>[绿色]&#123;.green&#125;</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>[靛青]&#123;.aqua&#125;</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>[蓝色]&#123;.blue&#125;</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>[紫色]&#123;.purple&#125;</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>[灰色]&#123;.grey&#125;</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>快捷键 [Ctrl]&#123;.kbd&#125; + [C]&#123;.kbd .red&#125;</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>H<span class=\"token strike\"><span class=\"token punctuation\">~</span><span class=\"token content\">2</span><span class=\"token punctuation\">~</span></span>0</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>29^th^</pre></td></tr></table></figure><div class=\"note warning\">\n<p>因为  <code>markdown-it-pangu</code>  插件的缘故，某些代码中可能会被加入空格，这有可能导致一些解析错误，使用时需要注意。由于我在打字中基本上会自己添加空格，因此我把该插件的功能关闭了。如果要使用该插件的话，记得查看  <code>++下划线++</code>   <code>~~删除线~~</code>   <code>==荧光高亮==</code>  这些代码中间是否有空格。</p>\n</div>\n<p><ins>下划线</ins></p>\n<p><ins class=\"wavy\">波浪线</ins></p>\n<p><ins class=\"dot\">着重点</ins></p>\n<p><ins class=\"primary\">紫色下划线</ins></p>\n<p><ins class=\"wavy success\">绿色波浪线</ins></p>\n<p><ins class=\"dot warning\">黄色着重点</ins></p>\n<p><s>删除线</s></p>\n<p><s class=\"danger\">红色删除线</s></p>\n<p><mark>荧光高亮</mark></p>\n<p><span class=\"rainbow\">赤橙黄绿青蓝紫</span></p>\n<p><span class=\"red\">红色</span></p>\n<p><span class=\"pink\">粉色</span></p>\n<p><span class=\"orange\">橙色</span></p>\n<p><span class=\"yellow\">黄色</span></p>\n<p><span class=\"green\">绿色</span></p>\n<p><span class=\"aqua\">靛青</span></p>\n<p><span class=\"blue\">蓝色</span></p>\n<p><span class=\"purple\">紫色</span></p>\n<p><span class=\"grey\">灰色</span></p>\n<p>快捷键 <span class=\"kbd\">Ctrl</span> + <span class=\"kbd red\">C</span></p>\n<p>下标 H<sub>2</sub>0</p>\n<p>上标 29<sup>th</sup></p>\n<h2 id=\"隐藏文字\"><a class=\"markdownIt-Anchor\" href=\"#隐藏文字\">#</a> 隐藏文字</h2>\n<p>本功能基于  <code>markdownt-it-spoiler</code> ，使用语法是</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>!!balabala!! 鼠标放置时显示内容。</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>!!balabala!!&#123;.bulr&#125; 鼠标选中时显示内容</pre></td></tr></table></figure><p>注意这里的感叹号均为英文半角，左边的感叹号不要和前面的正文连接到一起。</p>\n<p><span class=\"spoiler\" title=\"...\">balabala</span>  鼠标放置时显示内容。</p>\n<p><span class=\"spoiler bulr\" title=\"...\">balabala</span> 鼠标选中时显示内容</p>\n<h2 id=\"标签块\"><a class=\"markdownIt-Anchor\" href=\"#标签块\">#</a> 标签块</h2>\n<p>语法格式如下：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>[:icon:text]&#123;.style&#125;</pre></td></tr></table></figure><p><code>:icon</code>  表示添加某个 icon 图标， <code>text</code>  为该标签的文本， <code>.style</code>  为该标签的样式，示例如下：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>[default]&#123;.label&#125;</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>[primary]&#123;.label .primary&#125;</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>[info]&#123;.label .info&#125;</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>[:heavy_check_mark:success]&#123;.label .success&#125;</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>[warning]&#123;.label .warning&#125;</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>[:broken_heart:danger]&#123;.label .danger&#125;</pre></td></tr></table></figure><p><span class=\"label\">default</span><br>\n<span class=\"label primary\">primary</span><br>\n<span class=\"label info\">info</span><br>\n<span class=\"label success\">✔️success</span><br>\n<span class=\"label warning\">warning</span><br>\n<span class=\"label danger\">💔danger</span></p>\n<h2 id=\"提醒块\"><a class=\"markdownIt-Anchor\" href=\"#提醒块\">#</a> 提醒块</h2>\n<p>语法格式为</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>::: type [no-icon]</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>:::</pre></td></tr></table></figure><p><code>type</code>  表示使用的提醒块样式， <code>no-icon</code>  表示不显示 icon 图标，为可选项，示例如下：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>:::default</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>默认默认</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>:::</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>:::primary</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>基本基本</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>:::</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>:::info</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>提示提示</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>:::</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>:::success</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>成功成功</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>:::</pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>:::warning</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>警告警告</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>:::</pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>:::danger</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>危险危险</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>:::</pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>:::danger no-icon</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>危险危险</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>:::</pre></td></tr></table></figure><div class=\"note default\">\n<p>默认默认</p>\n</div>\n<div class=\"note primary\">\n<p>基本基本</p>\n</div>\n<div class=\"note info\">\n<p>提示提示</p>\n</div>\n<div class=\"note success\">\n<p>成功成功</p>\n</div>\n<div class=\"note warning\">\n<p>警告警告</p>\n</div>\n<div class=\"note danger\">\n<p>危险危险</p>\n</div>\n<div class=\"note danger no-icon\">\n<p>危险危险</p>\n</div>\n<h2 id=\"标签卡\"><a class=\"markdownIt-Anchor\" href=\"#标签卡\">#</a> 标签卡</h2>\n<p>标签卡片的语法如下：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>;;;<span class=\"token url\">[<span class=\"token content\">id</span>] [<span class=\"token variable\">text</span>]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>content</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>;;;</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>;;;<span class=\"token url\">[<span class=\"token content\">id</span>] [<span class=\"token variable\">text</span>]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>content</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>;;;</pre></td></tr></table></figure><p><code>id</code>  用于识别各个标签所属的卡片，有相同  <code>id</code>  的标签会被放在一张卡片中，读者可以点击卡片上的  <code>text</code>  切换对应的标签。 <code>content</code>  可以编写复合  <code>markdown</code>  语法的内容。示例如下：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>;;;id1 卡片 1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>这里是卡片 1 的内容</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token bold\"><span class=\"token punctuation\">**</span><span class=\"token content\">加粗</span><span class=\"token punctuation\">**</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>[success]&#123;.label .success&#125;</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>;;;</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>;;;id1 卡片 2</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>这里是卡片 2 的内容</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>:::danger</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>危险危险</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>:::</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token list punctuation\">-</span> 第一行</pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token list punctuation\">-</span> 第二行</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>;;;</pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>;;;id2 ②号标签卡片 1</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>这里是卡片 1 的内容</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>;;;</pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>;;;id2 ②号标签卡片 2</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>这里是卡片 2 的内容</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>;;;</pre></td></tr></table></figure><div class=\"tab\" data-id=\"id1\" data-title=\"卡片 1\">\n<p>这里是卡片 1 的内容<br>\n<strong>加粗</strong><br>\n<span class=\"label success\"> success</span></p>\n<div class=\"links\"><div class=\"item\" title=\"霜月琉璃\" style=\"--block-color:#e9546b;\"><a href=\"https://shoka.lostyu.me\" class=\"image\" data-background-image=\"https://cdn.jsdelivr.net/gh/amehime/shoka@latest/images/avatar.jpg\"></a>\n        <div class=\"info\">\n        <a href=\"https://shoka.lostyu.me\" class=\"title\">優萌初華</a>\n        <p class=\"desc\">琉璃的医学 & 编程笔记</p>\n        </div></div></div>\n</div>\n<div class=\"tab\" data-id=\"id1\" data-title=\"卡片 2\">\n<p>这里是卡片 2 的内容</p>\n<div class=\"note danger\">\n<p>危险危险</p>\n</div>\n<ul>\n<li>第一行</li>\n<li>第二行</li>\n</ul>\n</div>\n<div class=\"tab\" data-id=\"id2\" data-title=\"②号标签卡片 1\">\n<p>这里是卡片 1 的内容</p>\n</div>\n<div class=\"tab\" data-id=\"id2\" data-title=\"②号标签卡片 2\">\n<p>这里是卡片 2 的内容</p>\n</div>\n<p>我经常用到的应该是下面这种展示不同语言代码的标签卡：</p>\n<div class=\"tab\" data-id=\"code\" data-title=\"Cpp\">\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure></div>\n<div class=\"tab\" data-id=\"code\" data-title=\"Python\">\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure></div>\n<h2 id=\"折叠块\"><a class=\"markdownIt-Anchor\" href=\"#折叠块\">#</a> 折叠块</h2>\n<p>折叠块语法如下：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>+++<span class=\"token url\">[<span class=\"token content\">style</span>] [<span class=\"token variable\">title</span>]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>content</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>+++</pre></td></tr></table></figure><p><code>style</code>  表示折叠块的样式，为空则使用默认样式。 <code>title</code>  为折叠块上的文本内容。 <code>content</code>  中可以添加符合  <code>markdown</code>  语法的内容。</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>+++ 默认默认 这里是一段文字</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>++下划线++</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>+++</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>+++primary 紫色</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>:::info</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>参考信息</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>:::</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token list punctuation\">-</span> 第一行</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token list punctuation\">-</span> 第二行</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>+++</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>+++info  蓝色</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>;;;id3 卡片 1</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>这里是卡片 1 的内容</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>;;;</pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>;;;id3 卡片 2</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>这里是卡片 2 的内容</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>;;;</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>+++</pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>+++success 绿色</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>+++</pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>+++warning 黄色</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>!! 警告警告警告警告警告！！&#123;.bulr&#125;</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>[label]&#123;.label .success&#125;</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>+++</pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>+++danger 红色</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>[danger]&#123;.label .danger&#125;</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>+++</pre></td></tr></table></figure><details><summary>默认默认 这里是一段文字</summary><div>\n<p><ins>下划线</ins></p>\n</div></details>\n<details class=\"primary\"><summary>紫色</summary><div>\n<div class=\"note info\">\n<p>参考信息</p>\n</div>\n<ul>\n<li>第一行</li>\n<li>第二行</li>\n</ul>\n</div></details>\n<details class=\"info\"><summary>蓝色</summary><div>\n<div class=\"tab\" data-id=\"id3\" data-title=\"卡片 1\">\n<p>这里是卡片 1 的内容</p>\n</div>\n<div class=\"tab\" data-id=\"id3\" data-title=\"卡片 2\">\n<p>这里是卡片 2 的内容</p>\n</div>\n</div></details>\n<details class=\"success\"><summary>绿色</summary><div>\n</div></details>\n<details class=\"warning\"><summary>黄色</summary><div>\n<p>!! 警告警告警告警告警告！！{.bulr}<br>\n<span class=\"label success\">label</span></p>\n</div></details>\n<details class=\"danger\"><summary>红色</summary><div>\n<p><span class=\"label danger\">danger</span></p>\n</div></details>\n<h2 id=\"待办事项\"><a class=\"markdownIt-Anchor\" href=\"#待办事项\">#</a> 待办事项</h2>\n<p>本功能语法如下：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token list punctuation\">-</span> [mark]  text</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token list punctuation\">-</span> [mark]  text </pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>&#123;.style&#125;</pre></td></tr></table></figure><p><code>mark</code>  为可选项，使用  <code>x</code>  填充，表示该项完成， <code>style</code>  表示显示的样式，为空则使用默认样式。注意  <code>&#123;.style&#125;</code>  和上一个选项之间需要插入一个空行。</p>\n<p>示例如下：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token list punctuation\">-</span> [ ] 这是一个小叉叉</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token list punctuation\">-</span> [x] 这是一个红色勾勾 </pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>&#123;.danger&#125;</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token list punctuation\">-</span> [ ] 未完成</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token list punctuation\">-</span> [x] 完成 </pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>&#123;.primary&#125;</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token list punctuation\">-</span> [ ] 未完成</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token list punctuation\">-</span> [x] 默认颜色</pre></td></tr></table></figure><ul class=\"task-list danger\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_0\" disabled=\"true\"><label for=\"cbx_0\"> 这是一个小叉叉</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_1\" checked=\"true\" disabled=\"true\"><label for=\"cbx_1\"> 这是一个红色勾勾</label></li>\n</ul>\n<ul class=\"task-list primary\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_2\" disabled=\"true\"><label for=\"cbx_2\"> 未完成</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_3\" checked=\"true\" disabled=\"true\"><label for=\"cbx_3\"> 完成</label></li>\n</ul>\n<ul class=\"task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_4\" disabled=\"true\"><label for=\"cbx_4\"> 未完成</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_5\" checked=\"true\" disabled=\"true\"><label for=\"cbx_5\"> 默认颜色</label></li>\n</ul>\n<h2 id=\"文字注音\"><a class=\"markdownIt-Anchor\" href=\"#文字注音\">#</a> 文字注音</h2>\n<p>该功能主要用于日语汉字假名注音，或者标示振假名（振り仮名），也就是常说的写作 “xx”，读作 “YY”，比如说 <ruby>紳士<rp>【</rp><rt>へんたい</rt><rp>】</rp></ruby>。理论上也可以用于别的注音。</p>\n<p>作者为了兼容性，在  <code>markdown-it-ruby</code>  的基础上采用  <code>&#123;文字^注音&#125;</code>  的格式进行注音，为了兼容表格，将分隔符由  <code>|</code>  换成了  <code>^</code>  。</p>\n<p>注音分隔基于  <code>furigana-markdown-it</code> ，显示说明可以点击<a href=\"https://www.npmjs.com/package/furigana-markdown-it#quick-usage\">此链接</a></p>\n<p>语法：</p>\n<p>示例：</p>\n<p>–|–<br>\n <code>&#123;取り返す^とりかえす&#125;</code> |<ruby> 取<rp>【</rp><rt>と</rt><rp>】</rp>り<rt></rt>返<rp>【</rp><rt>かえ</rt><rp>】</rp>す<rt></rt></ruby><br>\n <code>&#123;可愛い犬^か+わい・い・いぬ&#125;</code> |<ruby> 可愛<rp>【</rp><rt>かわい</rt><rp>】</rp>い<rt></rt>犬<rp>【</rp><rt>いぬ</rt><rp>】</rp></ruby><br>\n <code>&#123;可愛い犬^か・わい・いいぬ&#125;</code> |<ruby> 可<rp>【</rp><rt>か</rt><rp>】</rp>愛<rp>【</rp><rt>わい</rt><rp>】</rp>い<rt></rt>犬<rp>【</rp><rt>いぬ</rt><rp>】</rp></ruby><br>\n <code>&#123;アクセラレータ^accelerator&#125;</code>  | <ruby>アクセラレータ<rp>【</rp><rt>accelerator</rt><rp>】</rp></ruby><br>\n <code>&#123;accelerator^アクセラレータ&#125;</code>  | <ruby>accelerator<rp>【</rp><rt>アクセラレータ</rt><rp>】</rp></ruby><br>\n <code>&#123;食べる^たべる&#125;</code>  | <ruby>食<rp>【</rp><rt>た</rt><rp>】</rp>べる<rt></rt></ruby><br>\n <code>&#123;食べる^=たべる&#125;</code>  | <ruby>食べる<rp>【</rp><rt>たべる</rt><rp>】</rp></ruby><br>\n <code>&#123;あいうえお^*&#125;</code>  | <ruby>あ<rt>●</rt>い<rt>●</rt>う<rt>●</rt>え<rt>●</rt>お<rt>●</rt></ruby><br>\n <code>&#123;あいうえお^*❤&#125;</code>  | <ruby>あ<rt>❤</rt>い<rt>❤</rt>う<rt>❤</rt>え<rt>❤</rt>お<rt>❤</rt></ruby><br>\n <code>&#123;常用账号^contact&#125;</code> |<ruby> 常用账号<rp>【</rp><rt>contact</rt><rp>】</rp></ruby></p>\n<h2 id=\"多媒体\"><a class=\"markdownIt-Anchor\" href=\"#多媒体\">#</a> 多媒体</h2>\n<p>多媒体内容，作者使用了  <code>Hexo</code>  的  <code>tag</code>  功能，语法如下：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">\n  {% media [audio|video]%}\n  {% endmedia %}\n</span></pre></td></tr></table></figure><p>详细示例见下，标签中包含一段  <code>yml</code>  格式的内容，格式与<a href=\"../config/#%E8%83%8C%E6%99%AF%E9%9F%B3%E4%B9%90\">背景音乐</a>的配置类似。亦可以直接使用网易云、虾米、QQ 音乐的播放列表、单曲。</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">\n{% media audio %}\n\n- title: 列表 1\n  list:\n  - https://music.163.com/#/playlist?id=2943811283\n  - https://music.163.com/#/playlist?id=2297706586\n- title: 列表 2\n  list:\n  - https://music.163.com/#/playlist?id=2031842656\n{% endmedia %}\n</span></pre></td></tr></table></figure><p>音乐播放列表效果如下：</p>\n<div class=\"media-container\"><div class=\"player\" data-type=\"audio\" data-src='[{\"title\":\"列表 1\",\"list\":[\"https://music.163.com/#/playlist?id=2943811283\",\"https://music.163.com/#/playlist?id=2297706586\"]},{\"title\":\"列表 2\",\"list\":[\"https://music.163.com/#/playlist?id=2031842656\"]}]'></div></div>\n<p>原本作者提供的功能是支持视频的，但是我经常看的视频网站  <code>bilibili</code>  的视频如果直接使用视频的  <code>url</code>  来获取会得到  <code>ERR_DECODED_FAILED</code>  错误。经过查找发现  <code>bilibili</code>  的视频需要通过  <code>bilibili</code>  提供的视频分享链接来嵌入到网页中，因此我使用了另一个插件来插入视频。而关于其他网站的视频，目前我只测试过腾讯视频一个，也是需要嵌入网页中的方式来插入视频。理论上，如果将视频也传输到  <code>github</code>  上，通过本地路径应该是能够访问成功的，但是一般的视频文件都很大，加上  <code>github</code>  经常网络感人，因此几乎不太可能用到这种方法。 <span class=\"spoiler\" title=\"...\">除非自己搭建一个服务器</span></p>\n<p>我目前使用的插件是 <a href=\"https://github.com/u2sb/hexo-tag-mmedia\"> <code>mmedia</code> </a>，详细使用方式可以查看其<a href=\"https://www.u2sb.com/pages/748f02/\">文档</a>。该插件支持插入很多类型的多媒体，这里我主要使用  <code>bilibili</code>  相关的功能。其插入  <code>bilibili</code>  视频的语法如下：</p>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">\n  {% mmedia \"bilibili\" \"bvid:1G64y1t7G9\" \"danmaku:false\" %}\n</span></pre></td></tr></table></figure><p><code>bvid</code>  填写视频的  <code>BV</code>  号， <code>danmaku</code>  控制视频是否显示弹幕。</p>\n<p>效果如下：</p>\n<style>.bbplayer{width: 100%; max-width: 850px; margin: auto}</style><div class=\"bbplayer\"><iframe class=\"bbplayer\" id=\"mmedia-lfDqXIAOcTHKOljr\" src=\"https://player.bilibili.com/player.html?bvid=1G64y1t7G9&page=1&high_quality=1&danmaku=false&autoplay=0\" allowfullscreen=\"allowfullscreen\" scrolling=\"no\" border=\"0\" frameborder=\"0\" framespacing=\"0\" sandbox=\"allow-top-navigation allow-same-origin allow-forms allow-scripts allow-popups\"></iframe></div><script> document.getElementById(\"mmedia-lfDqXIAOcTHKOljr\").style.height=document.getElementById(\"mmedia-lfDqXIAOcTHKOljr\").scrollWidth*0.76+\"px\";\n    window.onresize = function(){\n      document.getElementById(\"mmedia-lfDqXIAOcTHKOljr\").style.height=document.getElementById(\"mmedia-lfDqXIAOcTHKOljr\").scrollWidth*0.76+\"px\";\n    }; </script>\n<h2 id=\"数学公式\"><a class=\"markdownIt-Anchor\" href=\"#数学公式\">#</a> 数学公式</h2>\n<p>本功能基于  <code>markdown-it-katex</code> ，需要在  <code>Front Matter</code>  中添加  <code>math: true</code>  以支持<a href=\"https://katex.org/\"> KaTex</a>。从搜索的结果来看， <code>KaTex</code>  不完全支持  <code>LaTex</code>  的语法，不过目前暂时没发现大的问题，而且目前支持  <code>MathJax</code>  的  <code>hexo-math</code>  插件好像也有些许  <code>bug</code> 。后续如果有功能无法满足的时候再考虑更换  <code>MathJax</code> ，姑且先使用  <code>KaTex</code> 。</p>\n<p>行内公式：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msqrt><mrow><mn>3</mn><mi>x</mi><mo>−</mo><mn>1</mn></mrow></msqrt><mo>+</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>+</mo><mi>x</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\sqrt {3x-1}+(1+x)^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.1744em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8656em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">3</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-2.8256em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1744em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></p>\n<p>独立块显示：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi mathvariant=\"normal\">∇</mi><mo>×</mo><mover accent=\"true\"><mi mathvariant=\"bold\">B</mi><mo>⃗</mo></mover><mo>−</mo><mtext> </mtext><mfrac><mn>1</mn><mi>c</mi></mfrac><mtext> </mtext><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mover accent=\"true\"><mi mathvariant=\"bold\">E</mi><mo>⃗</mo></mover></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>t</mi></mrow></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>=</mo><mfrac><mrow><mn>4</mn><mi>π</mi></mrow><mi>c</mi></mfrac><mover accent=\"true\"><mi mathvariant=\"bold\">j</mi><mo>⃗</mo></mover><mi mathvariant=\"normal\">∇</mi><mo>⋅</mo><mover accent=\"true\"><mi mathvariant=\"bold\">E</mi><mo>⃗</mo></mover></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>=</mo><mn>4</mn><mi>π</mi><mi>ρ</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi mathvariant=\"normal\">∇</mi><mo>×</mo><mover accent=\"true\"><mi mathvariant=\"bold\">E</mi><mo>⃗</mo></mover><mtext> </mtext><mo>+</mo><mtext> </mtext><mfrac><mn>1</mn><mi>c</mi></mfrac><mtext> </mtext><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mover accent=\"true\"><mi mathvariant=\"bold\">B</mi><mo>⃗</mo></mover></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>t</mi></mrow></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>=</mo><mover accent=\"true\"><mn mathvariant=\"bold\">0</mn><mo>⃗</mo></mover></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi mathvariant=\"normal\">∇</mi><mo>⋅</mo><mover accent=\"true\"><mi mathvariant=\"bold\">B</mi><mo>⃗</mo></mover></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin {array}{c}\n\n\\nabla \\times \\vec {\\mathbf {B}} -\\, \\frac1c\\, \\frac {\\partial\\vec {\\mathbf {E}}}{\\partial t} &amp;\n= \\frac {4\\pi}{c}\\vec {\\mathbf {j}}    \\nabla \\cdot \\vec {\\mathbf {E}} &amp; = 4 \\pi \\rho \\\\\n\n\\nabla \\times \\vec {\\mathbf {E}}\\, +\\, \\frac1c\\, \\frac {\\partial\\vec {\\mathbf {B}}}{\\partial t} &amp; = \\vec {\\mathbf {0}} \\\\\n\n\\nabla \\cdot \\vec {\\mathbf {B}} &amp; = 0\n\n\\end {array}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.1939em;vertical-align:-1.8469em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.3469em;\"><span style=\"top:-4.3469em;\"><span class=\"pstrut\" style=\"height:3.0724em;\"></span><span class=\"mord\"><span class=\"mord\">∇</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9691em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">B</span></span><span style=\"top:-3.2551em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1522em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0724em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal mtight\">t</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord accent mtight\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9691em;\"><span style=\"top:-2.714em;\"><span class=\"pstrut\" style=\"height:2.714em;\"></span><span class=\"mord mathbf mtight\">E</span></span><span style=\"top:-2.9691em;\"><span class=\"pstrut\" style=\"height:2.714em;\"></span><span class=\"accent-body\" style=\"left:-0.1522em;\"><span class=\"overlay mtight\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.9146em;\"><span class=\"pstrut\" style=\"height:3.0724em;\"></span><span class=\"mord\"><span class=\"mord\">∇</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9691em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">E</span></span><span style=\"top:-3.2551em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1522em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0724em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal mtight\">t</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord accent mtight\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9691em;\"><span style=\"top:-2.714em;\"><span class=\"pstrut\" style=\"height:2.714em;\"></span><span class=\"mord mathbf mtight\">B</span></span><span style=\"top:-2.9691em;\"><span class=\"pstrut\" style=\"height:2.714em;\"></span><span class=\"accent-body\" style=\"left:-0.1522em;\"><span class=\"overlay mtight\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-1.5854em;\"><span class=\"pstrut\" style=\"height:3.0724em;\"></span><span class=\"mord\"><span class=\"mord\">∇</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9691em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">B</span></span><span style=\"top:-3.2551em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1522em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8469em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.3469em;\"><span style=\"top:-4.3469em;\"><span class=\"pstrut\" style=\"height:3.0724em;\"></span><span class=\"mord\"><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">4</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9774em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">j</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2355em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mord\">∇</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9691em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">E</span></span><span style=\"top:-3.2551em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1522em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span></span></span><span style=\"top:-2.9146em;\"><span class=\"pstrut\" style=\"height:3.0724em;\"></span><span class=\"mord\"><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9274em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">0</span></span><span style=\"top:-3.2134em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2355em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span></span></span><span style=\"top:-1.5854em;\"><span class=\"pstrut\" style=\"height:3.0724em;\"></span><span class=\"mord\"><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8469em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.3469em;\"><span style=\"top:-4.3469em;\"><span class=\"pstrut\" style=\"height:3.0724em;\"></span><span class=\"mord\"><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">4</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\">ρ</span></span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span></span></span></span></span></span></span></p>\n<h2 id=\"流程图\"><a class=\"markdownIt-Anchor\" href=\"#流程图\">#</a> 流程图</h2>\n<p>本功能基于  <code>markdown-it-mermaid</code> ，在  <code>Front Matter</code>  中添加  <code>mermaid: true</code>  以支持<a href=\"https://mermaid-js.github.io/mermaid/#/\"> Mermaid</a>。</p>\n<div class=\"note warning\">\n<p>需要注意代码块中的内容需要符合  <code>mermaid</code>  语法格式，否则会报错。详细的语法格式可以查看上面的链接，我自己也还在学习中。关于  <code>Mermaid</code>  的  <code>css</code>  样式，我暂时还没找到替换的方式。由于该功能可能不太常用，默认样式基本能够满足需求了。</p>\n</div>\n<div class=\"note warning\">\n<p>现在  <code>mermaid</code>  无法正常显示，想要解决的话，可以尝试参考<a href=\"https://blog.liq2.com/article/ff29002e\">这篇文章</a>。我这里因为几乎用不到  <code>mermaid</code> ，因此就不再折腾了。</p>\n</div>\n<figure class=\"highlight mermaid\"><figcaption data-lang=\"mermaid\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">graph</span> LR</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    A<span class=\"token text string\">[Square Rect]</span> <span class=\"token inter-arrow-label\"><span class=\"token arrow-head arrow operator\">--</span> <span class=\"token label property\">Link text</span> <span class=\"token arrow operator\">--></span></span> B<span class=\"token text string\">((Circle))</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    A <span class=\"token arrow operator\">--></span> C<span class=\"token text string\">(Round Rect)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    B <span class=\"token arrow operator\">--></span> D<span class=\"token text string\">&#123;Rhombus&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    C <span class=\"token arrow operator\">--></span> D</pre></td></tr></table></figure><figure class=\"highlight mermaid\"><figcaption data-lang=\"mermaid\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">sequenceDiagram</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">loop</span> Daily query</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        Alice<span class=\"token arrow operator\">->></span>Bob<span class=\"token operator\">:</span> Hello Bob, how are you?</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">alt</span> is sick</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            Bob<span class=\"token arrow operator\">->></span>Alice<span class=\"token operator\">:</span> Not so good <span class=\"token operator\">:</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">else</span> is well</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            Bob<span class=\"token arrow operator\">->></span>Alice<span class=\"token operator\">:</span> Feeling fresh like a daisy</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">opt</span> Extra response</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            Bob<span class=\"token arrow operator\">->></span>Alice<span class=\"token operator\">:</span> Thanks for asking</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">end</span></pre></td></tr></table></figure><h2 id=\"脚注\"><a class=\"markdownIt-Anchor\" href=\"#脚注\">#</a> 脚注</h2>\n<p>脚注功能基于  <code>markdown-it-footnote</code>  插件。使用格式为  <code>[^note]</code> ，然后在末尾添加对应的  <code>[^note]: note content</code> ，注意这里的冒号  <code>:</code>  不可省略，否则脚注不能正常解析。</p>\n<p>这是一个脚注 <sup class=\"footnote-ref\"><a href=\"#fn1\" id=\"fnref1\">[1]</a></sup> 这是另一个 footnote <sup class=\"footnote-ref\"><a href=\"#fn2\" id=\"fnref2\">[2]</a></sup>。</p>\n<p>脚注的标识符中尽量不要使用纯数字，我在测试中发现显示的时候会多出一个序号，影响美观，不知道其他使用者是否出现了该情况。</p>\n<h2 id=\"其他功能\"><a class=\"markdownIt-Anchor\" href=\"#其他功能\">#</a> 其他功能</h2>\n<p><code>markdown-it-graphviz</code>  插件基于 <a href=\"http://www.graphviz.org/\">Graphviz</a>， <code>markdown-it-chart</code>  插件基于 <a href=\"https://frappe.io/charts\">Frappe Charts</a>。这两个插件主要用于绘图，我应该大概率用不到这个插件。故这里不去详细了解，后续有需求再考虑。</p>\n<p><code>markdownt-it-excert</code>  插件暂时还不了解有什么作用。😅</p>\n<hr class=\"footnotes-sep\">\n<section class=\"footnotes\">\n<ol class=\"footnotes-list\">\n<li id=\"fn1\" class=\"footnote-item\"><p>脚注 <a href=\"#fnref1\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn2\" class=\"footnote-item\"><p>另一个脚注 <a href=\"#fnref2\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n</ol>\n</section>\n",
            "tags": [
                "Hexo"
            ]
        }
    ]
}