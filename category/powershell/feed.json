{
    "version": "https://jsonfeed.org/version/1",
    "title": "林•初夏 • All posts by \"powershell\" category",
    "description": "Linn 的个人博客",
    "home_page_url": "https://linn-ylz.com",
    "items": [
        {
            "id": "https://linn-ylz.com/Computer-Science/Configs/powershell-configs/",
            "url": "https://linn-ylz.com/Computer-Science/Configs/powershell-configs/",
            "title": "Powershell 配置",
            "date_published": "2023-04-01T07:44:34.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>虽然目前  <code>Windows</code>  对  <code>WSL</code>  已经支持很多常规的操作，但是有时候仍然不得不在  <code>Windows</code>  环境下执行某些命令。尤其  <code>WSL</code>  的文件  <code>IO</code>  速率相比于原生  <code>Windows</code>  系统存在一定差距，尤其是  <code>Git</code>  仓库稍微大一点便能明显感受到延迟。此外， <code>WSL</code>  的网络代理有时候也会出现故障， <code>Git</code>  操作很不方便。因此，基于  <code>Powershell</code>  配置一些支持常用操作，能够更方便自己的开发。</p>\n<h2 id=\"升级\"><a class=\"anchor\" href=\"#升级\">#</a> 升级</h2>\n<p>由于需要使用到一些模块，因此需要首先升级系统的  <code>Powershell</code>  ， <code>Windows</code>  官方提供了多种可选方式升级或安装最新的  <code>Powershell</code> ，参见<a href=\"https://learn.microsoft.com/zh-cn/powershell/scripting/install/installing-powershell-on-windows?view=powershell-7.3\">在 Windows 上安装 PowerShell - PowerShell | Microsoft Learn</a>。<sup class=\"footnote-ref\"><a href=\"#fn1\" id=\"fnref1\">[1]</a></sup></p>\n<p>如果网络状况良好，那么推荐直接使用  <code>winget</code>  命令安装。否则也可以下载  <code>msi</code>  安装包安装。</p>\n<h2 id=\"autosuggestion-工具\"><a class=\"anchor\" href=\"#autosuggestion-工具\">#</a> Autosuggestion 工具</h2>\n<p><code>WSL</code>  下可以通过  <code>oh-my-zsh</code>  配置  <code>auto-suggestion</code>  工具，可以在输入命令时显示以往使用的命令。 <code>Powershell</code>  也可以配置类似的工具。<sup class=\"footnote-ref\"><a href=\"#fn2\" id=\"fnref2\">[2]</a></sup></p>\n<p>使用该工具需要安装相关依赖：</p>\n<pre><code class=\"language-powershell\">Install-Module PSReadLine -RequiredVersion 2.1.0\n</code></pre>\n<p>安装完成后，可以使用以下命令启用 Autosuggestion 功能：</p>\n<pre><code class=\"language-powershell\">Import-Module PSReadLine\nSet-PSReadLineOption -PredictionSource History\n</code></pre>\n<p>以上命令只在当前窗口有效。如果需要默认启动，需要编辑配置文件。</p>\n<h3 id=\"编辑-powershell-配置文件\"><a class=\"anchor\" href=\"#编辑-powershell-配置文件\">#</a> 编辑  <code>Powershell</code>  配置文件</h3>\n<p>首先需要检查是否已有配置文件：</p>\n<pre><code class=\"language-powershell\">Test-path $profile\n</code></pre>\n<p>如果结果为  <code>True</code> ，说明已经包含该文件。为  <code>False</code> ，则需要自行生成：</p>\n<pre><code class=\"language-powershell\">New-item –type file –force $profile\n</code></pre>\n<p>执行命令设置执行权限（该命令需要管理员权限）：</p>\n<pre><code class=\"language-powershell\">Set-ExecutionPolicy RemoteSigned\n</code></pre>\n<p>之后编辑该文件：</p>\n<pre><code class=\"language-powershell\">notepad $profile\n</code></pre>\n<p>将语句添加到该配置文件中：</p>\n<pre><code class=\"language-powershell\">Import-Module PSReadLine\nSet-PSReadLineOption -PredictionSource History\n</code></pre>\n<p>此外，该工具也支持其他功能：</p>\n<pre><code class=\"language-powershell\"># Shows navigable menu of all options when hitting Tab\nSet-PSReadlineKeyHandler -Key Tab -Function MenuComplete\n\n# Autocompletion for arrow keys\nSet-PSReadlineKeyHandler -Key UpArrow -Function HistorySearchBackward\nSet-PSReadlineKeyHandler -Key DownArrow -Function HistorySearchForward\n</code></pre>\n<h2 id=\"ls-命令显示高亮\"><a class=\"anchor\" href=\"#ls-命令显示高亮\">#</a>  <code>ls</code>  命令显示高亮</h2>\n<p><a href=\"https://stackoverflow.com/a/30788506\">https://stackoverflow.com/a/30788506</a></p>\n<p>通过以下命令安装  <code>Color</code>  模块，支持  <code>ls</code>  命令显示高亮<sup class=\"footnote-ref\"><a href=\"#fn3\" id=\"fnref3\">[3]</a></sup>：</p>\n<pre><code class=\"language-powershell\">Install-Module Color\n</code></pre>\n<p>之后，在配置文件中添加导入模块语句：</p>\n<pre><code class=\"language-powershell\">Import-Module Color \n</code></pre>\n<h2 id=\"美化\"><a class=\"anchor\" href=\"#美化\">#</a> 美化</h2>\n<p>类似于  <code>oh-my-zsh</code> ， <code>Powershell</code>  可以使用  <code>oh-my-posh</code>  来美化。</p>\n<p>使用以下命令安装  <code>oh-my-posh</code> ：</p>\n<pre><code class=\"language-powershell\">winget install JanDeDobbeleer.OhMyPosh -s winget\n</code></pre>\n<h3 id=\"启用主题\"><a class=\"anchor\" href=\"#启用主题\">#</a> 启用主题</h3>\n<p>使用以下命令可以激活自己想要的主题：</p>\n<pre><code class=\"language-powershell\">oh-my-posh init pwsh --config &quot;$env:POSH_THEMES_PATH/ys.omp.json&quot; | Invoke-Expression;\n</code></pre>\n<p>其中  <code>ys</code>  是想要启用的主题的名称，终端主题可以在官方网站主题页面查看。<sup class=\"footnote-ref\"><a href=\"#fn4\" id=\"fnref4\">[4]</a></sup></p>\n<p>以上命令也可以加入到  <code>Powershell</code>  的配置文件中。</p>\n<h3 id=\"安装字体\"><a class=\"anchor\" href=\"#安装字体\">#</a> 安装字体</h3>\n<p>许多主题可能用到了特殊字符，如果终端中出现了方块显示的符号，可以下载官方推荐的 Nerd 字体。<sup class=\"footnote-ref\"><a href=\"#fn5\" id=\"fnref5\">[5]</a></sup></p>\n<p>字体下载网站：<a href=\"https://www.nerdfonts.com/font-downloads\">Nerd Fonts - Iconic font aggregator, glyphs/icons collection, &amp; fonts patcher</a></p>\n<h3 id=\"posh-git-模块\"><a class=\"anchor\" href=\"#posh-git-模块\">#</a>  <code>posh-git</code>  模块</h3>\n<p>安装  <code>posh-git</code>  模块可以为  <code>oh-my-posh</code>  提供  <code>git</code>  状态显示和命令补全等功能。使用以下命令安装：</p>\n<pre><code class=\"language-powershell\">Install-Module posh-git\n</code></pre>\n<p>并在配置文件中添加导入语句。</p>\n<p>注意，在某些较大的  <code>Git</code>  仓库中，该模块可能会影响实际的性能，因此可以视情况决定是否启用。</p>\n<hr class=\"footnotes-sep\" />\n<section class=\"footnotes\">\n<ol class=\"footnotes-list\">\n<li id=\"fn1\" class=\"footnote-item\"><p><a href=\"https://learn.microsoft.com/zh-cn/powershell/scripting/install/installing-powershell-on-windows?view=powershell-7.3\">在 Windows 上安装 PowerShell - PowerShell | Microsoft Learn</a> <a href=\"#fnref1\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn2\" class=\"footnote-item\"><p><a href=\"https://dev.to/animo/fish-like-autosuggestion-in-powershell-21ec\">Fish-like Autosuggestion in Powershell - DEV Community 👩‍💻👨‍💻</a> <a href=\"#fnref2\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn3\" class=\"footnote-item\"><p><a href=\"https://stackoverflow.com/questions/9406434/powershell-properly-coloring-get-childitem-output-once-and-for-all/30788506#30788506\">colors - Powershell: Properly coloring Get-Childitem output once and for all - Stack Overflow</a> <a href=\"#fnref3\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn4\" class=\"footnote-item\"><p><a href=\"https://ohmyposh.dev/docs/themes\">Themes | Oh My Posh</a> <a href=\"#fnref4\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn5\" class=\"footnote-item\"><p><a href=\"https://www.nerdfonts.com/font-downloads\">Nerd Fonts - Iconic font aggregator, glyphs/icons collection, &amp; fonts patcher</a> <a href=\"#fnref5\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n</ol>\n</section>\n",
            "tags": [
                "Computer-Science",
                "Configs",
                "Powershell"
            ]
        }
    ]
}